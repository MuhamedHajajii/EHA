import './polyfills.server.mjs';
import{g as In}from"./chunk-EHOGTAIJ.mjs";import{a as An}from"./chunk-3E4TOBEZ.mjs";import{b as zn}from"./chunk-ARICS7XC.mjs";import{q as Mn}from"./chunk-64Z7HWIM.mjs";import{$a as Te,Da as st,Ea as Ft,P as gn,U as xn,Xa as qt,Z as yn,_a as Ne,ab as Me,bb as lt,cb as yt,db as ze,eb as bn,fb as En,ga as _n,gb as Ie,ha as vn,kb as kn,lb as Sn,mb as $n,ob as Bn,pb as Nn,ra as wn,vb as Tn,ya as Cn}from"./chunk-PL6I6VDO.mjs";import"./chunk-VVCT4QZE.mjs";var Vt="http://www.w3.org/1999/xhtml",Ae={svg:"http://www.w3.org/2000/svg",xhtml:Vt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function K(e){var n=e+="",t=n.indexOf(":");return t>=0&&(n=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),Ae.hasOwnProperty(n)?{space:Ae[n],local:e}:e}function li(e){return function(){var n=this.ownerDocument,t=this.namespaceURI;return t===Vt&&n.documentElement.namespaceURI===Vt?n.createElement(e):n.createElementNS(t,e)}}function ui(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Wt(e){var n=K(e);return(n.local?ui:li)(n)}function ci(){}function ut(e){return e==null?ci:function(){return this.querySelector(e)}}function Rn(e){typeof e!="function"&&(e=ut(e));for(var n=this._groups,t=n.length,r=new Array(t),o=0;o<t;++o)for(var i=n[o],s=i.length,a=r[o]=new Array(s),c,l,u=0;u<s;++u)(c=i[u])&&(l=e.call(c,c.__data__,u,i))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new A(r,this._parents)}function Re(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function fi(){return[]}function $t(e){return e==null?fi:function(){return this.querySelectorAll(e)}}function hi(e){return function(){return Re(e.apply(this,arguments))}}function Ln(e){typeof e=="function"?e=hi(e):e=$t(e);for(var n=this._groups,t=n.length,r=[],o=[],i=0;i<t;++i)for(var s=n[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&(r.push(e.call(c,c.__data__,l,s)),o.push(c));return new A(r,o)}function Bt(e){return function(){return this.matches(e)}}function Ut(e){return function(n){return n.matches(e)}}var di=Array.prototype.find;function pi(e){return function(){return di.call(this.children,e)}}function mi(){return this.firstElementChild}function Xn(e){return this.select(e==null?mi:pi(typeof e=="function"?e:Ut(e)))}var gi=Array.prototype.filter;function xi(){return Array.from(this.children)}function yi(e){return function(){return gi.call(this.children,e)}}function Dn(e){return this.selectAll(e==null?xi:yi(typeof e=="function"?e:Ut(e)))}function On(e){typeof e!="function"&&(e=Bt(e));for(var n=this._groups,t=n.length,r=new Array(t),o=0;o<t;++o)for(var i=n[o],s=i.length,a=r[o]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new A(r,this._parents)}function Qt(e){return new Array(e.length)}function Pn(){return new A(this._enter||this._groups.map(Qt),this._parents)}function Nt(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}Nt.prototype={constructor:Nt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Hn(e){return function(){return e}}function _i(e,n,t,r,o,i){for(var s=0,a,c=n.length,l=i.length;s<l;++s)(a=n[s])?(a.__data__=i[s],r[s]=a):t[s]=new Nt(e,i[s]);for(;s<c;++s)(a=n[s])&&(o[s]=a)}function vi(e,n,t,r,o,i,s){var a,c,l=new Map,u=n.length,h=i.length,d=new Array(u),p;for(a=0;a<u;++a)(c=n[a])&&(d[a]=p=s.call(c,c.__data__,a,n)+"",l.has(p)?o[a]=c:l.set(p,c));for(a=0;a<h;++a)p=s.call(e,i[a],a,i)+"",(c=l.get(p))?(r[a]=c,c.__data__=i[a],l.delete(p)):t[a]=new Nt(e,i[a]);for(a=0;a<u;++a)(c=n[a])&&l.get(d[a])===c&&(o[a]=c)}function wi(e){return e.__data__}function Yn(e,n){if(!arguments.length)return Array.from(this,wi);var t=n?vi:_i,r=this._parents,o=this._groups;typeof e!="function"&&(e=Hn(e));for(var i=o.length,s=new Array(i),a=new Array(i),c=new Array(i),l=0;l<i;++l){var u=r[l],h=o[l],d=h.length,p=Ci(e.call(u,u&&u.__data__,l,r)),g=p.length,y=a[l]=new Array(g),w=s[l]=new Array(g),_=c[l]=new Array(d);t(u,h,y,w,_,p,n);for(var k=0,N=0,B,z;k<g;++k)if(B=y[k]){for(k>=N&&(N=k+1);!(z=w[N])&&++N<g;);B._next=z||null}}return s=new A(s,r),s._enter=a,s._exit=c,s}function Ci(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fn(){return new A(this._exit||this._groups.map(Qt),this._parents)}function qn(e,n,t){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),n!=null&&(o=n(o),o&&(o=o.selection())),t==null?i.remove():t(i),r&&o?r.merge(o).order():o}function Vn(e){for(var n=e.selection?e.selection():e,t=this._groups,r=n._groups,o=t.length,i=r.length,s=Math.min(o,i),a=new Array(o),c=0;c<s;++c)for(var l=t[c],u=r[c],h=l.length,d=a[c]=new Array(h),p,g=0;g<h;++g)(p=l[g]||u[g])&&(d[g]=p);for(;c<o;++c)a[c]=t[c];return new A(a,this._parents)}function Wn(){for(var e=this._groups,n=-1,t=e.length;++n<t;)for(var r=e[n],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Un(e){e||(e=bi);function n(h,d){return h&&d?e(h.__data__,d.__data__):!h-!d}for(var t=this._groups,r=t.length,o=new Array(r),i=0;i<r;++i){for(var s=t[i],a=s.length,c=o[i]=new Array(a),l,u=0;u<a;++u)(l=s[u])&&(c[u]=l);c.sort(n)}return new A(o,this._parents).order()}function bi(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function Qn(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Gn(){return Array.from(this)}function Jn(){for(var e=this._groups,n=0,t=e.length;n<t;++n)for(var r=e[n],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Zn(){let e=0;for(let n of this)++e;return e}function Kn(){return!this.node()}function jn(e){for(var n=this._groups,t=0,r=n.length;t<r;++t)for(var o=n[t],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function Ei(e){return function(){this.removeAttribute(e)}}function ki(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Si(e,n){return function(){this.setAttribute(e,n)}}function $i(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function Bi(e,n){return function(){var t=n.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function Ni(e,n){return function(){var t=n.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function tr(e,n){var t=K(e);if(arguments.length<2){var r=this.node();return t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}return this.each((n==null?t.local?ki:Ei:typeof n=="function"?t.local?Ni:Bi:t.local?$i:Si)(t,n))}function Gt(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ti(e){return function(){this.style.removeProperty(e)}}function Mi(e,n,t){return function(){this.style.setProperty(e,n,t)}}function zi(e,n,t){return function(){var r=n.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,t)}}function er(e,n,t){return arguments.length>1?this.each((n==null?Ti:typeof n=="function"?zi:Mi)(e,n,t??"")):rt(this.node(),e)}function rt(e,n){return e.style.getPropertyValue(n)||Gt(e).getComputedStyle(e,null).getPropertyValue(n)}function Ii(e){return function(){delete this[e]}}function Ai(e,n){return function(){this[e]=n}}function Ri(e,n){return function(){var t=n.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function nr(e,n){return arguments.length>1?this.each((n==null?Ii:typeof n=="function"?Ri:Ai)(e,n)):this.node()[e]}function rr(e){return e.trim().split(/^|\s+/)}function Le(e){return e.classList||new or(e)}function or(e){this._node=e,this._names=rr(e.getAttribute("class")||"")}or.prototype={add:function(e){var n=this._names.indexOf(e);n<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ir(e,n){for(var t=Le(e),r=-1,o=n.length;++r<o;)t.add(n[r])}function ar(e,n){for(var t=Le(e),r=-1,o=n.length;++r<o;)t.remove(n[r])}function Li(e){return function(){ir(this,e)}}function Xi(e){return function(){ar(this,e)}}function Di(e,n){return function(){(n.apply(this,arguments)?ir:ar)(this,e)}}function sr(e,n){var t=rr(e+"");if(arguments.length<2){for(var r=Le(this.node()),o=-1,i=t.length;++o<i;)if(!r.contains(t[o]))return!1;return!0}return this.each((typeof n=="function"?Di:n?Li:Xi)(t,n))}function Oi(){this.textContent=""}function Pi(e){return function(){this.textContent=e}}function Hi(e){return function(){var n=e.apply(this,arguments);this.textContent=n??""}}function lr(e){return arguments.length?this.each(e==null?Oi:(typeof e=="function"?Hi:Pi)(e)):this.node().textContent}function Yi(){this.innerHTML=""}function Fi(e){return function(){this.innerHTML=e}}function qi(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n??""}}function ur(e){return arguments.length?this.each(e==null?Yi:(typeof e=="function"?qi:Fi)(e)):this.node().innerHTML}function Vi(){this.nextSibling&&this.parentNode.appendChild(this)}function cr(){return this.each(Vi)}function Wi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fr(){return this.each(Wi)}function hr(e){var n=typeof e=="function"?e:Wt(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function Ui(){return null}function dr(e,n){var t=typeof e=="function"?e:Wt(e),r=n==null?Ui:typeof n=="function"?n:ut(n);return this.select(function(){return this.insertBefore(t.apply(this,arguments),r.apply(this,arguments)||null)})}function Qi(){var e=this.parentNode;e&&e.removeChild(this)}function pr(){return this.each(Qi)}function Gi(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function Ji(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function mr(e){return this.select(e?Ji:Gi)}function gr(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Zi(e){return function(n){e.call(this,n,this.__data__)}}function Ki(e){return e.trim().split(/^|\s+/).map(function(n){var t="",r=n.indexOf(".");return r>=0&&(t=n.slice(r+1),n=n.slice(0,r)),{type:n,name:t}})}function ji(e){return function(){var n=this.__on;if(n){for(var t=0,r=-1,o=n.length,i;t<o;++t)i=n[t],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):n[++r]=i;++r?n.length=r:delete this.__on}}}function ta(e,n,t){return function(){var r=this.__on,o,i=Zi(n);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=t),o.value=n;return}}this.addEventListener(e.type,i,t),o={type:e.type,name:e.name,value:n,listener:i,options:t},r?r.push(o):this.__on=[o]}}function xr(e,n,t){var r=Ki(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(o=0,u=a[c];o<i;++o)if((s=r[o]).type===u.type&&s.name===u.name)return u.value}return}for(a=n?ta:ji,o=0;o<i;++o)this.each(a(r[o],n,t));return this}function yr(e,n,t){var r=Gt(e),o=r.CustomEvent;typeof o=="function"?o=new o(n,t):(o=r.document.createEvent("Event"),t?(o.initEvent(n,t.bubbles,t.cancelable),o.detail=t.detail):o.initEvent(n,!1,!1)),e.dispatchEvent(o)}function ea(e,n){return function(){return yr(this,e,n)}}function na(e,n){return function(){return yr(this,e,n.apply(this,arguments))}}function _r(e,n){return this.each((typeof n=="function"?na:ea)(e,n))}function*vr(){for(var e=this._groups,n=0,t=e.length;n<t;++n)for(var r=e[n],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var Xe=[null];function A(e,n){this._groups=e,this._parents=n}function wr(){return new A([[document.documentElement]],Xe)}function ra(){return this}A.prototype=wr.prototype={constructor:A,select:Rn,selectAll:Ln,selectChild:Xn,selectChildren:Dn,filter:On,data:Yn,enter:Pn,exit:Fn,join:qn,merge:Vn,selection:ra,order:Wn,sort:Un,call:Qn,nodes:Gn,node:Jn,size:Zn,empty:Kn,each:jn,attr:tr,style:er,property:nr,classed:sr,text:lr,html:ur,raise:cr,lower:fr,append:hr,insert:dr,remove:pr,clone:mr,datum:gr,on:xr,dispatch:_r,[Symbol.iterator]:vr};var V=wr;function D(e){return typeof e=="string"?new A([[document.querySelector(e)]],[document.documentElement]):new A([[e]],Xe)}function Cr(e){let n;for(;n=e.sourceEvent;)e=n;return e}function j(e,n){if(e=Cr(e),n===void 0&&(n=e.currentTarget),n){var t=n.ownerSVGElement||n;if(t.createSVGPoint){var r=t.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}if(n.getBoundingClientRect){var o=n.getBoundingClientRect();return[e.clientX-o.left-n.clientLeft,e.clientY-o.top-n.clientTop]}}return[e.pageX,e.pageY]}function Jt(e,n){var t=0,r=0;return Float64Array.from(e,n===void 0?o=>t+=+o||0:o=>t+=+n(o,r++,e)||0)}function Zt(e,n){let t;if(n===void 0)for(let r of e)r!=null&&(t<r||t===void 0&&r>=r)&&(t=r);else{let r=-1;for(let o of e)(o=n(o,++r,e))!=null&&(t<o||t===void 0&&o>=o)&&(t=o)}return t}function Kt(e,n){let t;if(n===void 0)for(let r of e)r!=null&&(t>r||t===void 0&&r>=r)&&(t=r);else{let r=-1;for(let o of e)(o=n(o,++r,e))!=null&&(t>o||t===void 0&&o>=o)&&(t=o)}return t}function jt(e,n){let t=0;if(n===void 0)for(let r of e)(r=+r)&&(t+=r);else{let r=-1;for(let o of e)(o=+n(o,++r,e))&&(t+=o)}return t}function oa(e){var n=0,t=e.children,r=t&&t.length;if(!r)n=1;else for(;--r>=0;)n+=t[r].value;e.value=n}function br(){return this.eachAfter(oa)}function Er(e,n){let t=-1;for(let r of this)e.call(n,r,++t,this);return this}function kr(e,n){for(var t=this,r=[t],o,i,s=-1;t=r.pop();)if(e.call(n,t,++s,this),o=t.children)for(i=o.length-1;i>=0;--i)r.push(o[i]);return this}function Sr(e,n){for(var t=this,r=[t],o=[],i,s,a,c=-1;t=r.pop();)if(o.push(t),i=t.children)for(s=0,a=i.length;s<a;++s)r.push(i[s]);for(;t=o.pop();)e.call(n,t,++c,this);return this}function $r(e,n){let t=-1;for(let r of this)if(e.call(n,r,++t,this))return r}function Br(e){return this.eachAfter(function(n){for(var t=+e(n.data)||0,r=n.children,o=r&&r.length;--o>=0;)t+=r[o].value;n.value=t})}function Nr(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})}function Tr(e){for(var n=this,t=ia(n,e),r=[n];n!==t;)n=n.parent,r.push(n);for(var o=r.length;e!==t;)r.splice(o,0,e),e=e.parent;return r}function ia(e,n){if(e===n)return e;var t=e.ancestors(),r=n.ancestors(),o=null;for(e=t.pop(),n=r.pop();e===n;)o=e,e=t.pop(),n=r.pop();return o}function Mr(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n}function zr(){return Array.from(this)}function Ir(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e}function Ar(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n}function*Rr(){var e=this,n,t=[e],r,o,i;do for(n=t.reverse(),t=[];e=n.pop();)if(yield e,r=e.children)for(o=0,i=r.length;o<i;++o)t.push(r[o]);while(t.length)}function De(e,n){e instanceof Map?(e=[void 0,e],n===void 0&&(n=la)):n===void 0&&(n=sa);for(var t=new ot(e),r,o=[t],i,s,a,c;r=o.pop();)if((s=n(r.data))&&(c=(s=Array.from(s)).length))for(r.children=s,a=c-1;a>=0;--a)o.push(i=s[a]=new ot(s[a])),i.parent=r,i.depth=r.depth+1;return t.eachBefore(Oe)}function aa(){return De(this).eachBefore(ua)}function sa(e){return e.children}function la(e){return Array.isArray(e)?e[1]:null}function ua(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Oe(e){var n=0;do e.height=n;while((e=e.parent)&&e.height<++n)}function ot(e){this.data=e,this.depth=this.height=0,this.parent=null}ot.prototype=De.prototype={constructor:ot,count:br,each:Er,eachAfter:Sr,eachBefore:kr,find:$r,sum:Br,sort:Nr,path:Tr,ancestors:Mr,descendants:zr,leaves:Ir,links:Ar,copy:aa,[Symbol.iterator]:Rr};function te(e){return e==null?null:ca(e)}function ca(e){if(typeof e!="function")throw new Error;return e}var fa={depth:-1},Lr={},Pe={};function ha(e){return e.id}function da(e){return e.parentId}function Ye(){var e=ha,n=da,t;function r(o){var i=Array.from(o),s=e,a=n,c,l,u,h,d,p,g,y,w=new Map;if(t!=null){let _=i.map((B,z)=>pa(t(B,z,o))),k=_.map(Xr),N=new Set(_).add("");for(let B of k)N.has(B)||(N.add(B),_.push(B),k.push(Xr(B)),i.push(Pe));s=(B,z)=>_[z],a=(B,z)=>k[z]}for(u=0,c=i.length;u<c;++u)l=i[u],p=i[u]=new ot(l),(g=s(l,u,o))!=null&&(g+="")&&(y=p.id=g,w.set(y,w.has(y)?Lr:p)),(g=a(l,u,o))!=null&&(g+="")&&(p.parent=g);for(u=0;u<c;++u)if(p=i[u],g=p.parent){if(d=w.get(g),!d)throw new Error("missing: "+g);if(d===Lr)throw new Error("ambiguous: "+g);d.children?d.children.push(p):d.children=[p],p.parent=d}else{if(h)throw new Error("multiple roots");h=p}if(!h)throw new Error("no root");if(t!=null){for(;h.data===Pe&&h.children.length===1;)h=h.children[0],--c;for(let _=i.length-1;_>=0&&(p=i[_],p.data===Pe);--_)p.data=null}if(h.parent=fa,h.eachBefore(function(_){_.depth=_.parent.depth+1,--c}).eachBefore(Oe),h.parent=null,c>0)throw new Error("cycle");return h}return r.id=function(o){return arguments.length?(e=te(o),r):e},r.parentId=function(o){return arguments.length?(n=te(o),r):n},r.path=function(o){return arguments.length?(t=te(o),r):t},r}function pa(e){e=`${e}`;let n=e.length;return He(e,n-1)&&!He(e,n-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function Xr(e){let n=e.length;if(n<2)return"";for(;--n>1&&!He(e,n););return e.slice(0,n)}function He(e,n){if(e[n]==="/"){let t=0;for(;n>0&&e[--n]==="\\";)++t;if(!(t&1))return!0}return!1}function ma(e,n){return e.parent===n.parent?1:2}function Fe(e){var n=e.children;return n?n[0]:e.t}function qe(e){var n=e.children;return n?n[n.length-1]:e.t}function ga(e,n,t){var r=t/(n.i-e.i);n.c-=r,n.s+=t,e.c+=r,n.z+=t,n.m+=t}function xa(e){for(var n=0,t=0,r=e.children,o=r.length,i;--o>=0;)i=r[o],i.z+=n,i.m+=n,n+=i.s+(t+=i.c)}function ya(e,n,t){return e.a.parent===n.parent?e.a:t}function ee(e,n){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}ee.prototype=Object.create(ot.prototype);function _a(e){for(var n=new ee(e,0),t,r=[n],o,i,s,a;t=r.pop();)if(i=t._.children)for(t.children=new Array(a=i.length),s=a-1;s>=0;--s)r.push(o=t.children[s]=new ee(i[s],s)),o.parent=t;return(n.parent=new ee(null,0)).children=[n],n}function Ve(){var e=ma,n=1,t=1,r=null;function o(l){var u=_a(l);if(u.eachAfter(i),u.parent.m=-u.z,u.eachBefore(s),r)l.eachBefore(c);else{var h=l,d=l,p=l;l.eachBefore(function(k){k.x<h.x&&(h=k),k.x>d.x&&(d=k),k.depth>p.depth&&(p=k)});var g=h===d?1:e(h,d)/2,y=g-h.x,w=n/(d.x+g+y),_=t/(p.depth||1);l.eachBefore(function(k){k.x=(k.x+y)*w,k.y=k.depth*_})}return l}function i(l){var u=l.children,h=l.parent.children,d=l.i?h[l.i-1]:null;if(u){xa(l);var p=(u[0].z+u[u.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-p):l.z=p}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||h[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,u,h){if(u){for(var d=l,p=l,g=u,y=d.parent.children[0],w=d.m,_=p.m,k=g.m,N=y.m,B;g=qe(g),d=Fe(d),g&&d;)y=Fe(y),p=qe(p),p.a=l,B=g.z+k-d.z-w+e(g._,d._),B>0&&(ga(ya(g,l,h),l,B),w+=B,_+=B),k+=g.m,w+=d.m,N+=y.m,_+=p.m;g&&!qe(p)&&(p.t=g,p.m+=k-_),d&&!Fe(y)&&(y.t=d,y.m+=w-N,h=l)}return h}function c(l){l.x*=n,l.y=l.depth*t}return o.separation=function(l){return arguments.length?(e=l,o):e},o.size=function(l){return arguments.length?(r=!1,n=+l[0],t=+l[1],o):r?null:[n,t]},o.nodeSize=function(l){return arguments.length?(r=!0,n=+l[0],t=+l[1],o):r?[n,t]:null},o}var va={value:()=>{}};function Or(){for(var e=0,n=arguments.length,t={},r;e<n;++e){if(!(r=arguments[e]+"")||r in t||/[\s.]/.test(r))throw new Error("illegal type: "+r);t[r]=[]}return new ne(t)}function ne(e){this._=e}function wa(e,n){return e.trim().split(/^|\s+/).map(function(t){var r="",o=t.indexOf(".");if(o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}ne.prototype=Or.prototype={constructor:ne,on:function(e,n){var t=this._,r=wa(e+"",t),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=Ca(t[o],e.name)))return o;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++i<s;)if(o=(e=r[i]).type)t[o]=Dr(t[o],e.name,n);else if(n==null)for(o in t)t[o]=Dr(t[o],e.name,null);return this},copy:function(){var e={},n=this._;for(var t in n)e[t]=n[t].slice();return new ne(e)},call:function(e,n){if((o=arguments.length-2)>0)for(var t=new Array(o),r=0,o,i;r<o;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(n,t)},apply:function(e,n,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(n,t)}};function Ca(e,n){for(var t=0,r=e.length,o;t<r;++t)if((o=e[t]).name===n)return o.value}function Dr(e,n,t){for(var r=0,o=e.length;r<o;++r)if(e[r].name===n){e[r]=va,e=e.slice(0,r).concat(e.slice(r+1));break}return t!=null&&e.push({name:n,value:t}),e}var Tt=Or;var re={capture:!0,passive:!1};function oe(e){e.preventDefault(),e.stopImmediatePropagation()}function We(e){var n=e.document.documentElement,t=D(e).on("dragstart.drag",oe,re);"onselectstart"in n?t.on("selectstart.drag",oe,re):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Ue(e,n){var t=e.document.documentElement,r=D(e).on("dragstart.drag",null);n&&(r.on("click.drag",oe,re),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in t?r.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}function ie(e,n,t){e.prototype=n.prototype=t,t.constructor=e}function Qe(e,n){var t=Object.create(e.prototype);for(var r in n)t[r]=n[r];return t}function It(){}var Mt=.7,le=1/Mt,_t="\\s*([+-]?\\d+)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Q="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ba=/^#([0-9a-f]{3,8})$/,Ea=new RegExp(`^rgb\\(${_t},${_t},${_t}\\)$`),ka=new RegExp(`^rgb\\(${Q},${Q},${Q}\\)$`),Sa=new RegExp(`^rgba\\(${_t},${_t},${_t},${zt}\\)$`),$a=new RegExp(`^rgba\\(${Q},${Q},${Q},${zt}\\)$`),Ba=new RegExp(`^hsl\\(${zt},${Q},${Q}\\)$`),Na=new RegExp(`^hsla\\(${zt},${Q},${Q},${zt}\\)$`),Pr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ie(It,it,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Hr,formatHex:Hr,formatHex8:Ta,formatHsl:Ma,formatRgb:Yr,toString:Yr});function Hr(){return this.rgb().formatHex()}function Ta(){return this.rgb().formatHex8()}function Ma(){return Qr(this).formatHsl()}function Yr(){return this.rgb().formatRgb()}function it(e){var n,t;return e=(e+"").trim().toLowerCase(),(n=ba.exec(e))?(t=n[1].length,n=parseInt(n[1],16),t===6?Fr(n):t===3?new P(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):t===8?ae(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):t===4?ae(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Ea.exec(e))?new P(n[1],n[2],n[3],1):(n=ka.exec(e))?new P(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Sa.exec(e))?ae(n[1],n[2],n[3],n[4]):(n=$a.exec(e))?ae(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Ba.exec(e))?Wr(n[1],n[2]/100,n[3]/100,1):(n=Na.exec(e))?Wr(n[1],n[2]/100,n[3]/100,n[4]):Pr.hasOwnProperty(e)?Fr(Pr[e]):e==="transparent"?new P(NaN,NaN,NaN,0):null}function Fr(e){return new P(e>>16&255,e>>8&255,e&255,1)}function ae(e,n,t,r){return r<=0&&(e=n=t=NaN),new P(e,n,t,r)}function za(e){return e instanceof It||(e=it(e)),e?(e=e.rgb(),new P(e.r,e.g,e.b,e.opacity)):new P}function vt(e,n,t,r){return arguments.length===1?za(e):new P(e,n,t,r??1)}function P(e,n,t,r){this.r=+e,this.g=+n,this.b=+t,this.opacity=+r}ie(P,vt,Qe(It,{brighter(e){return e=e==null?le:Math.pow(le,e),new P(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Mt:Math.pow(Mt,e),new P(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new P(ft(this.r),ft(this.g),ft(this.b),ue(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qr,formatHex:qr,formatHex8:Ia,formatRgb:Vr,toString:Vr}));function qr(){return`#${ct(this.r)}${ct(this.g)}${ct(this.b)}`}function Ia(){return`#${ct(this.r)}${ct(this.g)}${ct(this.b)}${ct((isNaN(this.opacity)?1:this.opacity)*255)}`}function Vr(){let e=ue(this.opacity);return`${e===1?"rgb(":"rgba("}${ft(this.r)}, ${ft(this.g)}, ${ft(this.b)}${e===1?")":`, ${e})`}`}function ue(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ft(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ct(e){return e=ft(e),(e<16?"0":"")+e.toString(16)}function Wr(e,n,t,r){return r<=0?e=n=t=NaN:t<=0||t>=1?e=n=NaN:n<=0&&(e=NaN),new W(e,n,t,r)}function Qr(e){if(e instanceof W)return new W(e.h,e.s,e.l,e.opacity);if(e instanceof It||(e=it(e)),!e)return new W;if(e instanceof W)return e;e=e.rgb();var n=e.r/255,t=e.g/255,r=e.b/255,o=Math.min(n,t,r),i=Math.max(n,t,r),s=NaN,a=i-o,c=(i+o)/2;return a?(n===i?s=(t-r)/a+(t<r)*6:t===i?s=(r-n)/a+2:s=(n-t)/a+4,a/=c<.5?i+o:2-i-o,s*=60):a=c>0&&c<1?0:s,new W(s,a,c,e.opacity)}function Gr(e,n,t,r){return arguments.length===1?Qr(e):new W(e,n,t,r??1)}function W(e,n,t,r){this.h=+e,this.s=+n,this.l=+t,this.opacity=+r}ie(W,Gr,Qe(It,{brighter(e){return e=e==null?le:Math.pow(le,e),new W(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Mt:Math.pow(Mt,e),new W(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*n,o=2*t-r;return new P(Ge(e>=240?e-240:e+120,o,r),Ge(e,o,r),Ge(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new W(Ur(this.h),se(this.s),se(this.l),ue(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=ue(this.opacity);return`${e===1?"hsl(":"hsla("}${Ur(this.h)}, ${se(this.s)*100}%, ${se(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ur(e){return e=(e||0)%360,e<0?e+360:e}function se(e){return Math.max(0,Math.min(1,e||0))}function Ge(e,n,t){return(e<60?n+(t-n)*e/60:e<180?t:e<240?n+(t-n)*(240-e)/60:n)*255}function Je(e,n,t,r,o){var i=e*e,s=i*e;return((1-3*e+3*i-s)*n+(4-6*i+3*s)*t+(1+3*e+3*i-3*s)*r+s*o)/6}function Jr(e){var n=e.length-1;return function(t){var r=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),o=e[r],i=e[r+1],s=r>0?e[r-1]:2*o-i,a=r<n-1?e[r+2]:2*i-o;return Je((t-r/n)*n,s,o,i,a)}}function Zr(e){var n=e.length;return function(t){var r=Math.floor(((t%=1)<0?++t:t)*n),o=e[(r+n-1)%n],i=e[r%n],s=e[(r+1)%n],a=e[(r+2)%n];return Je((t-r/n)*n,o,i,s,a)}}var Ze=e=>()=>e;function Aa(e,n){return function(t){return e+t*n}}function Ra(e,n,t){return e=Math.pow(e,t),n=Math.pow(n,t)-e,t=1/t,function(r){return Math.pow(e+r*n,t)}}function Kr(e){return(e=+e)==1?ce:function(n,t){return t-n?Ra(n,t,e):Ze(isNaN(n)?t:n)}}function ce(e,n){var t=n-e;return t?Aa(e,t):Ze(isNaN(e)?n:e)}var fe=function e(n){var t=Kr(n);function r(o,i){var s=t((o=vt(o)).r,(i=vt(i)).r),a=t(o.g,i.g),c=t(o.b,i.b),l=ce(o.opacity,i.opacity);return function(u){return o.r=s(u),o.g=a(u),o.b=c(u),o.opacity=l(u),o+""}}return r.gamma=e,r}(1);function jr(e){return function(n){var t=n.length,r=new Array(t),o=new Array(t),i=new Array(t),s,a;for(s=0;s<t;++s)a=vt(n[s]),r[s]=a.r||0,o[s]=a.g||0,i[s]=a.b||0;return r=e(r),o=e(o),i=e(i),a.opacity=1,function(c){return a.r=r(c),a.g=o(c),a.b=i(c),a+""}}}var La=jr(Jr),Xa=jr(Zr);function F(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}var je=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ke=new RegExp(je.source,"g");function Da(e){return function(){return e}}function Oa(e){return function(n){return e(n)+""}}function tn(e,n){var t=je.lastIndex=Ke.lastIndex=0,r,o,i,s=-1,a=[],c=[];for(e=e+"",n=n+"";(r=je.exec(e))&&(o=Ke.exec(n));)(i=o.index)>t&&(i=n.slice(t,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,c.push({i:s,x:F(r,o)})),t=Ke.lastIndex;return t<n.length&&(i=n.slice(t),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?Oa(c[0].x):Da(n):(n=c.length,function(l){for(var u=0,h;u<n;++u)a[(h=c[u]).i]=h.x(l);return a.join("")})}var to=180/Math.PI,he={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function en(e,n,t,r,o,i){var s,a,c;return(s=Math.sqrt(e*e+n*n))&&(e/=s,n/=s),(c=e*t+n*r)&&(t-=e*c,r-=n*c),(a=Math.sqrt(t*t+r*r))&&(t/=a,r/=a,c/=a),e*r<n*t&&(e=-e,n=-n,c=-c,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(n,e)*to,skewX:Math.atan(c)*to,scaleX:s,scaleY:a}}var de;function eo(e){let n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?he:en(n.a,n.b,n.c,n.d,n.e,n.f)}function no(e){return e==null?he:(de||(de=document.createElementNS("http://www.w3.org/2000/svg","g")),de.setAttribute("transform",e),(e=de.transform.baseVal.consolidate())?(e=e.matrix,en(e.a,e.b,e.c,e.d,e.e,e.f)):he)}function ro(e,n,t,r){function o(l){return l.length?l.pop()+" ":""}function i(l,u,h,d,p,g){if(l!==h||u!==d){var y=p.push("translate(",null,n,null,t);g.push({i:y-4,x:F(l,h)},{i:y-2,x:F(u,d)})}else(h||d)&&p.push("translate("+h+n+d+t)}function s(l,u,h,d){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),d.push({i:h.push(o(h)+"rotate(",null,r)-2,x:F(l,u)})):u&&h.push(o(h)+"rotate("+u+r)}function a(l,u,h,d){l!==u?d.push({i:h.push(o(h)+"skewX(",null,r)-2,x:F(l,u)}):u&&h.push(o(h)+"skewX("+u+r)}function c(l,u,h,d,p,g){if(l!==h||u!==d){var y=p.push(o(p)+"scale(",null,",",null,")");g.push({i:y-4,x:F(l,h)},{i:y-2,x:F(u,d)})}else(h!==1||d!==1)&&p.push(o(p)+"scale("+h+","+d+")")}return function(l,u){var h=[],d=[];return l=e(l),u=e(u),i(l.translateX,l.translateY,u.translateX,u.translateY,h,d),s(l.rotate,u.rotate,h,d),a(l.skewX,u.skewX,h,d),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,h,d),l=u=null,function(p){for(var g=-1,y=d.length,w;++g<y;)h[(w=d[g]).i]=w.x(p);return h.join("")}}}var nn=ro(eo,"px, ","px)","deg)"),rn=ro(no,", ",")",")");var Pa=1e-12;function oo(e){return((e=Math.exp(e))+1/e)/2}function Ha(e){return((e=Math.exp(e))-1/e)/2}function Ya(e){return((e=Math.exp(2*e))-1)/(e+1)}var on=function e(n,t,r){function o(i,s){var a=i[0],c=i[1],l=i[2],u=s[0],h=s[1],d=s[2],p=u-a,g=h-c,y=p*p+g*g,w,_;if(y<Pa)_=Math.log(d/l)/n,w=function(H){return[a+H*p,c+H*g,l*Math.exp(n*H*_)]};else{var k=Math.sqrt(y),N=(d*d-l*l+r*y)/(2*l*t*k),B=(d*d-l*l-r*y)/(2*d*t*k),z=Math.log(Math.sqrt(N*N+1)-N),X=Math.log(Math.sqrt(B*B+1)-B);_=(X-z)/n,w=function(H){var et=H*_,St=oo(z),nt=l/(t*k)*(St*Ya(n*et+z)-Ha(z));return[a+nt*p,c+nt*g,l*St/oo(n*et+z)]}}return w.duration=_*1e3*n/Math.SQRT2,w}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},o}(Math.SQRT2,2,4);var wt=0,Rt=0,At=0,ao=1e3,pe,Lt,me=0,ht=0,ge=0,Xt=typeof performance=="object"&&performance.now?performance:Date,so=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ot(){return ht||(so(Fa),ht=Xt.now()+ge)}function Fa(){ht=0}function Dt(){this._call=this._time=this._next=null}Dt.prototype=xe.prototype={constructor:Dt,restart:function(e,n,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?Ot():+t)+(n==null?0:+n),!this._next&&Lt!==this&&(Lt?Lt._next=this:pe=this,Lt=this),this._call=e,this._time=t,an()},stop:function(){this._call&&(this._call=null,this._time=1/0,an())}};function xe(e,n,t){var r=new Dt;return r.restart(e,n,t),r}function lo(){Ot(),++wt;for(var e=pe,n;e;)(n=ht-e._time)>=0&&e._call.call(void 0,n),e=e._next;--wt}function io(){ht=(me=Xt.now())+ge,wt=Rt=0;try{lo()}finally{wt=0,Va(),ht=0}}function qa(){var e=Xt.now(),n=e-me;n>ao&&(ge-=n,me=e)}function Va(){for(var e,n=pe,t,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:pe=t);Lt=e,an(r)}function an(e){if(!wt){Rt&&(Rt=clearTimeout(Rt));var n=e-ht;n>24?(e<1/0&&(Rt=setTimeout(io,e-Xt.now()-ge)),At&&(At=clearInterval(At))):(At||(me=Xt.now(),At=setInterval(qa,ao)),wt=1,so(io))}}function ye(e,n,t){var r=new Dt;return n=n==null?0:+n,r.restart(o=>{r.stop(),e(o+n)},n,t),r}var Wa=Tt("start","end","cancel","interrupt"),Ua=[],fo=0,uo=1,ve=2,_e=3,co=4,we=5,Pt=6;function at(e,n,t,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(t in s)return;Qa(e,t,{name:n,index:r,group:o,on:Wa,tween:Ua,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:fo})}function Ht(e,n){var t=R(e,n);if(t.state>fo)throw new Error("too late; already scheduled");return t}function L(e,n){var t=R(e,n);if(t.state>_e)throw new Error("too late; already running");return t}function R(e,n){var t=e.__transition;if(!t||!(t=t[n]))throw new Error("transition not found");return t}function Qa(e,n,t){var r=e.__transition,o;r[n]=t,t.timer=xe(i,0,t.time);function i(l){t.state=uo,t.timer.restart(s,t.delay,t.time),t.delay<=l&&s(l-t.delay)}function s(l){var u,h,d,p;if(t.state!==uo)return c();for(u in r)if(p=r[u],p.name===t.name){if(p.state===_e)return ye(s);p.state===co?(p.state=Pt,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[u]):+u<n&&(p.state=Pt,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[u])}if(ye(function(){t.state===_e&&(t.state=co,t.timer.restart(a,t.delay,t.time),a(l))}),t.state=ve,t.on.call("start",e,e.__data__,t.index,t.group),t.state===ve){for(t.state=_e,o=new Array(d=t.tween.length),u=0,h=-1;u<d;++u)(p=t.tween[u].value.call(e,e.__data__,t.index,t.group))&&(o[++h]=p);o.length=h+1}}function a(l){for(var u=l<t.duration?t.ease.call(null,l/t.duration):(t.timer.restart(c),t.state=we,1),h=-1,d=o.length;++h<d;)o[h].call(e,u);t.state===we&&(t.on.call("end",e,e.__data__,t.index,t.group),c())}function c(){t.state=Pt,t.timer.stop(),delete r[n];for(var l in r)return;delete e.__transition}}function dt(e,n){var t=e.__transition,r,o,i=!0,s;if(t){n=n==null?null:n+"";for(s in t){if((r=t[s]).name!==n){i=!1;continue}o=r.state>ve&&r.state<we,r.state=Pt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete t[s]}i&&delete e.__transition}}function ho(e){return this.each(function(){dt(this,e)})}function Ga(e,n){var t,r;return function(){var o=L(this,e),i=o.tween;if(i!==t){r=t=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===n){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function Ja(e,n,t){var r,o;if(typeof t!="function")throw new Error;return function(){var i=L(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:n,value:t},c=0,l=o.length;c<l;++c)if(o[c].name===n){o[c]=a;break}c===l&&o.push(a)}i.tween=o}}function po(e,n){var t=this._id;if(e+="",arguments.length<2){for(var r=R(this.node(),t).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((n==null?Ga:Ja)(t,e,n))}function Ct(e,n,t){var r=e._id;return e.each(function(){var o=L(this,r);(o.value||(o.value={}))[n]=t.apply(this,arguments)}),function(o){return R(o,r).value[n]}}function Ce(e,n){var t;return(typeof n=="number"?F:n instanceof it?fe:(t=it(n))?(n=t,fe):tn)(e,n)}function Za(e){return function(){this.removeAttribute(e)}}function Ka(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ja(e,n,t){var r,o=t+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=n(r=s,t)}}function ts(e,n,t){var r,o=t+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=n(r=s,t)}}function es(e,n,t){var r,o,i;return function(){var s,a=t(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=n(r=s,a)))}}function ns(e,n,t){var r,o,i;return function(){var s,a=t(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=n(r=s,a)))}}function mo(e,n){var t=K(e),r=t==="transform"?rn:Ce;return this.attrTween(e,typeof n=="function"?(t.local?ns:es)(t,r,Ct(this,"attr."+e,n)):n==null?(t.local?Ka:Za)(t):(t.local?ts:ja)(t,r,n))}function rs(e,n){return function(t){this.setAttribute(e,n.call(this,t))}}function os(e,n){return function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}}function is(e,n){var t,r;function o(){var i=n.apply(this,arguments);return i!==r&&(t=(r=i)&&os(e,i)),t}return o._value=n,o}function as(e,n){var t,r;function o(){var i=n.apply(this,arguments);return i!==r&&(t=(r=i)&&rs(e,i)),t}return o._value=n,o}function go(e,n){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(n==null)return this.tween(t,null);if(typeof n!="function")throw new Error;var r=K(e);return this.tween(t,(r.local?is:as)(r,n))}function ss(e,n){return function(){Ht(this,e).delay=+n.apply(this,arguments)}}function ls(e,n){return n=+n,function(){Ht(this,e).delay=n}}function xo(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?ss:ls)(n,e)):R(this.node(),n).delay}function us(e,n){return function(){L(this,e).duration=+n.apply(this,arguments)}}function cs(e,n){return n=+n,function(){L(this,e).duration=n}}function yo(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?us:cs)(n,e)):R(this.node(),n).duration}function fs(e,n){if(typeof n!="function")throw new Error;return function(){L(this,e).ease=n}}function _o(e){var n=this._id;return arguments.length?this.each(fs(n,e)):R(this.node(),n).ease}function hs(e,n){return function(){var t=n.apply(this,arguments);if(typeof t!="function")throw new Error;L(this,e).ease=t}}function vo(e){if(typeof e!="function")throw new Error;return this.each(hs(this._id,e))}function wo(e){typeof e!="function"&&(e=Bt(e));for(var n=this._groups,t=n.length,r=new Array(t),o=0;o<t;++o)for(var i=n[o],s=i.length,a=r[o]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new O(r,this._parents,this._name,this._id)}function Co(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,t=e._groups,r=n.length,o=t.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var c=n[a],l=t[a],u=c.length,h=s[a]=new Array(u),d,p=0;p<u;++p)(d=c[p]||l[p])&&(h[p]=d);for(;a<r;++a)s[a]=n[a];return new O(s,this._parents,this._name,this._id)}function ds(e){return(e+"").trim().split(/^|\s+/).every(function(n){var t=n.indexOf(".");return t>=0&&(n=n.slice(0,t)),!n||n==="start"})}function ps(e,n,t){var r,o,i=ds(n)?Ht:L;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(n,t),s.on=o}}function bo(e,n){var t=this._id;return arguments.length<2?R(this.node(),t).on.on(e):this.each(ps(t,e,n))}function ms(e){return function(){var n=this.parentNode;for(var t in this.__transition)if(+t!==e)return;n&&n.removeChild(this)}}function Eo(){return this.on("end.remove",ms(this._id))}function ko(e){var n=this._name,t=this._id;typeof e!="function"&&(e=ut(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],c=a.length,l=i[s]=new Array(c),u,h,d=0;d<c;++d)(u=a[d])&&(h=e.call(u,u.__data__,d,a))&&("__data__"in u&&(h.__data__=u.__data__),l[d]=h,at(l[d],n,t,d,l,R(u,t)));return new O(i,this._parents,n,t)}function So(e){var n=this._name,t=this._id;typeof e!="function"&&(e=$t(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var c=r[a],l=c.length,u,h=0;h<l;++h)if(u=c[h]){for(var d=e.call(u,u.__data__,h,c),p,g=R(u,t),y=0,w=d.length;y<w;++y)(p=d[y])&&at(p,n,t,y,d,g);i.push(d),s.push(u)}return new O(i,s,n,t)}var gs=V.prototype.constructor;function $o(){return new gs(this._groups,this._parents)}function xs(e,n){var t,r,o;return function(){var i=rt(this,e),s=(this.style.removeProperty(e),rt(this,e));return i===s?null:i===t&&s===r?o:o=n(t=i,r=s)}}function Bo(e){return function(){this.style.removeProperty(e)}}function ys(e,n,t){var r,o=t+"",i;return function(){var s=rt(this,e);return s===o?null:s===r?i:i=n(r=s,t)}}function _s(e,n,t){var r,o,i;return function(){var s=rt(this,e),a=t(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),rt(this,e))),s===c?null:s===r&&c===o?i:(o=c,i=n(r=s,a))}}function vs(e,n){var t,r,o,i="style."+n,s="end."+i,a;return function(){var c=L(this,e),l=c.on,u=c.value[i]==null?a||(a=Bo(n)):void 0;(l!==t||o!==u)&&(r=(t=l).copy()).on(s,o=u),c.on=r}}function No(e,n,t){var r=(e+="")=="transform"?nn:Ce;return n==null?this.styleTween(e,xs(e,r)).on("end.style."+e,Bo(e)):typeof n=="function"?this.styleTween(e,_s(e,r,Ct(this,"style."+e,n))).each(vs(this._id,e)):this.styleTween(e,ys(e,r,n),t).on("end.style."+e,null)}function ws(e,n,t){return function(r){this.style.setProperty(e,n.call(this,r),t)}}function Cs(e,n,t){var r,o;function i(){var s=n.apply(this,arguments);return s!==o&&(r=(o=s)&&ws(e,s,t)),r}return i._value=n,i}function To(e,n,t){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;return this.tween(r,Cs(e,n,t??""))}function bs(e){return function(){this.textContent=e}}function Es(e){return function(){var n=e(this);this.textContent=n??""}}function Mo(e){return this.tween("text",typeof e=="function"?Es(Ct(this,"text",e)):bs(e==null?"":e+""))}function ks(e){return function(n){this.textContent=e.call(this,n)}}function Ss(e){var n,t;function r(){var o=e.apply(this,arguments);return o!==t&&(n=(t=o)&&ks(o)),n}return r._value=e,r}function zo(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,Ss(e))}function Io(){for(var e=this._name,n=this._id,t=be(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,l=0;l<a;++l)if(c=s[l]){var u=R(c,n);at(c,e,t,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new O(r,this._parents,e,t)}function Ao(){var e,n,t=this,r=t._id,o=t.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--o===0&&i()}};t.each(function(){var l=L(this,r),u=l.on;u!==e&&(n=(e=u).copy(),n._.cancel.push(a),n._.interrupt.push(a),n._.end.push(c)),l.on=n}),o===0&&i()})}var $s=0;function O(e,n,t,r){this._groups=e,this._parents=n,this._name=t,this._id=r}function Ro(e){return V().transition(e)}function be(){return++$s}var tt=V.prototype;O.prototype=Ro.prototype={constructor:O,select:ko,selectAll:So,selectChild:tt.selectChild,selectChildren:tt.selectChildren,filter:wo,merge:Co,selection:$o,transition:Io,call:tt.call,nodes:tt.nodes,node:tt.node,size:tt.size,empty:tt.empty,each:tt.each,on:bo,attr:mo,attrTween:go,style:No,styleTween:To,text:Mo,textTween:zo,remove:Eo,tween:po,delay:xo,duration:yo,ease:_o,easeVarying:vo,end:Ao,[Symbol.iterator]:tt[Symbol.iterator]};function Ee(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Bs={time:null,delay:0,duration:250,ease:Ee};function Ns(e,n){for(var t;!(t=e.__transition)||!(t=t[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return t}function Lo(e){var n,t;e instanceof O?(n=e._id,e=e._name):(n=be(),(t=Bs).time=Ot(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&at(c,e,n,l,s,t||Ns(c,n));return new O(r,this._parents,e,n)}V.prototype.interrupt=ho;V.prototype.transition=Lo;var Yt=e=>()=>e;function sn(e,{sourceEvent:n,target:t,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function U(e,n,t){this.k=e,this.x=n,this.y=t}U.prototype={constructor:U,scale:function(e){return e===1?this:new U(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new U(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var pt=new U(1,0,0);ln.prototype=U.prototype;function ln(e){for(;!e.__zoom;)if(!(e=e.parentNode))return pt;return e.__zoom}function ke(e){e.stopImmediatePropagation()}function bt(e){e.preventDefault(),e.stopImmediatePropagation()}function Ts(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ms(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Xo(){return this.__zoom||pt}function zs(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Is(){return navigator.maxTouchPoints||"ontouchstart"in this}function As(e,n,t){var r=e.invertX(n[0][0])-t[0][0],o=e.invertX(n[1][0])-t[1][0],i=e.invertY(n[0][1])-t[0][1],s=e.invertY(n[1][1])-t[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function un(){var e=Ts,n=Ms,t=As,r=zs,o=Is,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=on,l=Tt("start","zoom","end"),u,h,d,p=500,g=150,y=0,w=10;function _(m){m.property("__zoom",Xo).on("wheel.zoom",et,{passive:!1}).on("mousedown.zoom",St).on("dblclick.zoom",nt).filter(o).on("touchstart.zoom",xt).on("touchmove.zoom",G).on("touchend.zoom touchcancel.zoom",mn).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(m,b,x,E){var S=m.selection?m.selection():m;S.property("__zoom",Xo),m!==S?z(m,b,x,E):S.interrupt().each(function(){X(this,arguments).event(E).start().zoom(null,typeof b=="function"?b.apply(this,arguments):b).end()})},_.scaleBy=function(m,b,x,E){_.scaleTo(m,function(){var S=this.__zoom.k,f=typeof b=="function"?b.apply(this,arguments):b;return S*f},x,E)},_.scaleTo=function(m,b,x,E){_.transform(m,function(){var S=n.apply(this,arguments),f=this.__zoom,v=x==null?B(S):typeof x=="function"?x.apply(this,arguments):x,C=f.invert(v),$=typeof b=="function"?b.apply(this,arguments):b;return t(N(k(f,$),v,C),S,s)},x,E)},_.translateBy=function(m,b,x,E){_.transform(m,function(){return t(this.__zoom.translate(typeof b=="function"?b.apply(this,arguments):b,typeof x=="function"?x.apply(this,arguments):x),n.apply(this,arguments),s)},null,E)},_.translateTo=function(m,b,x,E,S){_.transform(m,function(){var f=n.apply(this,arguments),v=this.__zoom,C=E==null?B(f):typeof E=="function"?E.apply(this,arguments):E;return t(pt.translate(C[0],C[1]).scale(v.k).translate(typeof b=="function"?-b.apply(this,arguments):-b,typeof x=="function"?-x.apply(this,arguments):-x),f,s)},E,S)};function k(m,b){return b=Math.max(i[0],Math.min(i[1],b)),b===m.k?m:new U(b,m.x,m.y)}function N(m,b,x){var E=b[0]-x[0]*m.k,S=b[1]-x[1]*m.k;return E===m.x&&S===m.y?m:new U(m.k,E,S)}function B(m){return[(+m[0][0]+ +m[1][0])/2,(+m[0][1]+ +m[1][1])/2]}function z(m,b,x,E){m.on("start.zoom",function(){X(this,arguments).event(E).start()}).on("interrupt.zoom end.zoom",function(){X(this,arguments).event(E).end()}).tween("zoom",function(){var S=this,f=arguments,v=X(S,f).event(E),C=n.apply(S,f),$=x==null?B(C):typeof x=="function"?x.apply(S,f):x,I=Math.max(C[1][0]-C[0][0],C[1][1]-C[0][1]),M=S.__zoom,Y=typeof b=="function"?b.apply(S,f):b,J=c(M.invert($).concat(I/M.k),Y.invert($).concat(I/Y.k));return function(q){if(q===1)q=Y;else{var Z=J(q),Be=I/Z[2];q=new U(Be,$[0]-Z[0]*Be,$[1]-Z[1]*Be)}v.zoom(null,q)}})}function X(m,b,x){return!x&&m.__zooming||new H(m,b)}function H(m,b){this.that=m,this.args=b,this.active=0,this.sourceEvent=null,this.extent=n.apply(m,b),this.taps=0}H.prototype={event:function(m){return m&&(this.sourceEvent=m),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(m,b){return this.mouse&&m!=="mouse"&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&m!=="touch"&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&m!=="touch"&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(m){var b=D(this.that).datum();l.call(m,this.that,new sn(m,{sourceEvent:this.sourceEvent,target:_,type:m,transform:this.that.__zoom,dispatch:l}),b)}};function et(m,...b){if(!e.apply(this,arguments))return;var x=X(this,b).event(m),E=this.__zoom,S=Math.max(i[0],Math.min(i[1],E.k*Math.pow(2,r.apply(this,arguments)))),f=j(m);if(x.wheel)(x.mouse[0][0]!==f[0]||x.mouse[0][1]!==f[1])&&(x.mouse[1]=E.invert(x.mouse[0]=f)),clearTimeout(x.wheel);else{if(E.k===S)return;x.mouse=[f,E.invert(f)],dt(this),x.start()}bt(m),x.wheel=setTimeout(v,g),x.zoom("mouse",t(N(k(E,S),x.mouse[0],x.mouse[1]),x.extent,s));function v(){x.wheel=null,x.end()}}function St(m,...b){if(d||!e.apply(this,arguments))return;var x=m.currentTarget,E=X(this,b,!0).event(m),S=D(m.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",I,!0),f=j(m,x),v=m.clientX,C=m.clientY;We(m.view),ke(m),E.mouse=[f,this.__zoom.invert(f)],dt(this),E.start();function $(M){if(bt(M),!E.moved){var Y=M.clientX-v,J=M.clientY-C;E.moved=Y*Y+J*J>y}E.event(M).zoom("mouse",t(N(E.that.__zoom,E.mouse[0]=j(M,x),E.mouse[1]),E.extent,s))}function I(M){S.on("mousemove.zoom mouseup.zoom",null),Ue(M.view,E.moved),bt(M),E.event(M).end()}}function nt(m,...b){if(e.apply(this,arguments)){var x=this.__zoom,E=j(m.changedTouches?m.changedTouches[0]:m,this),S=x.invert(E),f=x.k*(m.shiftKey?.5:2),v=t(N(k(x,f),E,S),n.apply(this,b),s);bt(m),a>0?D(this).transition().duration(a).call(z,v,E,m):D(this).call(_.transform,v,E,m)}}function xt(m,...b){if(e.apply(this,arguments)){var x=m.touches,E=x.length,S=X(this,b,m.changedTouches.length===E).event(m),f,v,C,$;for(ke(m),v=0;v<E;++v)C=x[v],$=j(C,this),$=[$,this.__zoom.invert($),C.identifier],S.touch0?!S.touch1&&S.touch0[2]!==$[2]&&(S.touch1=$,S.taps=0):(S.touch0=$,f=!0,S.taps=1+!!u);u&&(u=clearTimeout(u)),f&&(S.taps<2&&(h=$[0],u=setTimeout(function(){u=null},p)),dt(this),S.start())}}function G(m,...b){if(this.__zooming){var x=X(this,b).event(m),E=m.changedTouches,S=E.length,f,v,C,$;for(bt(m),f=0;f<S;++f)v=E[f],C=j(v,this),x.touch0&&x.touch0[2]===v.identifier?x.touch0[0]=C:x.touch1&&x.touch1[2]===v.identifier&&(x.touch1[0]=C);if(v=x.that.__zoom,x.touch1){var I=x.touch0[0],M=x.touch0[1],Y=x.touch1[0],J=x.touch1[1],q=(q=Y[0]-I[0])*q+(q=Y[1]-I[1])*q,Z=(Z=J[0]-M[0])*Z+(Z=J[1]-M[1])*Z;v=k(v,Math.sqrt(q/Z)),C=[(I[0]+Y[0])/2,(I[1]+Y[1])/2],$=[(M[0]+J[0])/2,(M[1]+J[1])/2]}else if(x.touch0)C=x.touch0[0],$=x.touch0[1];else return;x.zoom("touch",t(N(v,C,$),x.extent,s))}}function mn(m,...b){if(this.__zooming){var x=X(this,b).event(m),E=m.changedTouches,S=E.length,f,v;for(ke(m),d&&clearTimeout(d),d=setTimeout(function(){d=null},p),f=0;f<S;++f)v=E[f],x.touch0&&x.touch0[2]===v.identifier?delete x.touch0:x.touch1&&x.touch1[2]===v.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(v=j(v,this),Math.hypot(h[0]-v[0],h[1]-v[1])<w)){var C=D(this).on("dblclick.zoom");C&&C.apply(this,arguments)}}}return _.wheelDelta=function(m){return arguments.length?(r=typeof m=="function"?m:Yt(+m),_):r},_.filter=function(m){return arguments.length?(e=typeof m=="function"?m:Yt(!!m),_):e},_.touchable=function(m){return arguments.length?(o=typeof m=="function"?m:Yt(!!m),_):o},_.extent=function(m){return arguments.length?(n=typeof m=="function"?m:Yt([[+m[0][0],+m[0][1]],[+m[1][0],+m[1][1]]]),_):n},_.scaleExtent=function(m){return arguments.length?(i[0]=+m[0],i[1]=+m[1],_):[i[0],i[1]]},_.translateExtent=function(m){return arguments.length?(s[0][0]=+m[0][0],s[1][0]=+m[1][0],s[0][1]=+m[0][1],s[1][1]=+m[1][1],_):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},_.constrain=function(m){return arguments.length?(t=m,_):t},_.duration=function(m){return arguments.length?(a=+m,_):a},_.interpolate=function(m){return arguments.length?(c=m,_):c},_.on=function(){var m=l.on.apply(l,arguments);return m===l?_:m},_.clickDistance=function(m){return arguments.length?(y=(m=+m)*m,_):Math.sqrt(y)},_.tapDistance=function(m){return arguments.length?(w=+m,_):w},_}function Rs(e){var n=0,t=e.children,r=t&&t.length;if(!r)n=1;else for(;--r>=0;)n+=t[r].value;e.value=n}function Do(){return this.eachAfter(Rs)}function Oo(e){var n=this,t,r=[n],o,i,s;do for(t=r.reverse(),r=[];n=t.pop();)if(e(n),o=n.children,o)for(i=0,s=o.length;i<s;++i)r.push(o[i]);while(r.length);return this}function Po(e){for(var n=this,t=[n],r,o;n=t.pop();)if(e(n),r=n.children,r)for(o=r.length-1;o>=0;--o)t.push(r[o]);return this}function Ho(e){for(var n=this,t=[n],r=[],o,i,s;n=t.pop();)if(r.push(n),o=n.children,o)for(i=0,s=o.length;i<s;++i)t.push(o[i]);for(;n=r.pop();)e(n);return this}function Yo(e){return this.eachAfter(function(n){for(var t=+e(n.data)||0,r=n.children,o=r&&r.length;--o>=0;)t+=r[o].value;n.value=t})}function Fo(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})}function qo(e){for(var n=this,t=Ls(n,e),r=[n];n!==t;)n=n.parent,r.push(n);for(var o=r.length;e!==t;)r.splice(o,0,e),e=e.parent;return r}function Ls(e,n){if(e===n)return e;var t=e.ancestors(),r=n.ancestors(),o=null;for(e=t.pop(),n=r.pop();e===n;)o=e,e=t.pop(),n=r.pop();return o}function Vo(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n}function Wo(){var e=[];return this.each(function(n){e.push(n)}),e}function Uo(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e}function Qo(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n}function Et(e,n){var t=new Se(e),r=+e.value&&(t.value=e.value),o,i=[t],s,a,c,l;for(n==null&&(n=Ds);o=i.pop();)if(r&&(o.value=+o.data.value),(a=n(o.data))&&(l=a.length))for(o.children=new Array(l),c=l-1;c>=0;--c)i.push(s=o.children[c]=new Se(a[c])),s.parent=o,s.depth=o.depth+1;return t.eachBefore(Ps)}function Xs(){return Et(this).eachBefore(Os)}function Ds(e){return e.children}function Os(e){e.data=e.data.data}function Ps(e){var n=0;do e.height=n;while((e=e.parent)&&e.height<++n)}function Se(e){this.data=e,this.depth=this.height=0,this.parent=null}Se.prototype=Et.prototype={constructor:Se,count:Do,each:Oo,eachAfter:Ho,eachBefore:Po,sum:Yo,sort:Fo,path:qo,ancestors:Vo,descendants:Wo,leaves:Uo,links:Qo,copy:Xs};var Go={name:"d3-flextree",version:"2.1.2",main:"build/d3-flextree.js",module:"index","jsnext:main":"index",author:{name:"Chris Maloney",url:"http://chrismaloney.org"},description:"Flexible tree layout algorithm that allows for variable node sizes.",keywords:["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],homepage:"https://github.com/klortho/d3-flextree",license:"WTFPL",repository:{type:"git",url:"https://github.com/klortho/d3-flextree.git"},scripts:{clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},dependencies:{"d3-hierarchy":"^1.1.5"},devDependencies:{"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"}};var{version:Ys}=Go,Fs=Object.freeze({children:e=>e.children,nodeSize:e=>e.data.size,spacing:0});function kt(e){let n=Object.assign({},Fs,e);function t(a){let c=n[a];return typeof c=="function"?c:()=>c}function r(a){let c=s(i(),a,l=>l.children);return c.update(),c.data}function o(){let a=t("nodeSize"),c=t("spacing");return class Jo extends Et.prototype.constructor{constructor(u){super(u)}copy(){let u=s(this.constructor,this,h=>h.children);return u.each(h=>h.data=h.data.data),u}get size(){return a(this)}spacing(u){return c(this,u)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){let u=this.ancestors();return u[u.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((u,h)=>Jo.maxExtents(u,h.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(u,h){return{top:Math.min(u.top,h.top),bottom:Math.max(u.bottom,h.bottom),left:Math.min(u.left,h.left),right:Math.max(u.right,h.right)}}}}function i(){let a=o(),c=t("nodeSize"),l=t("spacing");return class extends a{constructor(u){super(u),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return c(this.data)}spacing(u){return l(this.data,u.data)}get x(){return this.data.x}set x(u){this.data.x=u}get y(){return this.data.y}set y(u){this.data.y=u}update(){return Zo(this),Ko(this),this}}}function s(a,c,l){let u=(h,d)=>{let p=new a(h);Object.assign(p,{parent:d,depth:d===null?0:d.depth+1,height:0,length:1});let g=l(h)||[];return p.children=g.length===0?null:g.map(y=>u(y,p)),p.children&&Object.assign(p,p.children.reduce((y,w)=>({height:Math.max(y.height,w.height+1),length:y.length+w.length}),p)),p};return u(c,null)}return Object.assign(r,{nodeSize(a){return arguments.length?(n.nodeSize=a,r):n.nodeSize},spacing(a){return arguments.length?(n.spacing=a,r):n.spacing},children(a){return arguments.length?(n.children=a,r):n.children},hierarchy(a,c){let l=typeof c>"u"?n.children:c;return s(o(),a,l)},dump(a){let c=t("nodeSize"),l=u=>h=>{let d=u+"  ",p=u+"    ",{x:g,y}=h,w=c(h),_=h.children||[],k=_.length===0?" ":`,${d}children: [${p}${_.map(l(p)).join(p)}${d}],${u}`;return`{ size: [${w.join(", ")}],${d}x: ${g}, y: ${y}${k}},`};return l(`
`)(a)}}),r}kt.version=Ys;var Zo=(e,n=0)=>(e.y=n,(e.children||[]).reduce((t,r)=>{let[o,i]=t;Zo(r,e.y+e.ySize);let s=(o===0?r.lExt:r.rExt).bottom;o!==0&&Vs(e,o,i);let a=js(s,o,i);return[o+1,a]},[0,null]),qs(e),Ks(e),e),Ko=(e,n,t)=>{typeof n>"u"&&(n=-e.relX-e.prelim,t=0);let r=n+e.relX;return e.relX=r+e.prelim-t,e.prelim=0,e.x=t+e.relX,(e.children||[]).forEach(o=>Ko(o,r,e.x)),e},qs=e=>{(e.children||[]).reduce((n,t)=>{let[r,o]=n,i=r+t.shift,s=o+i+t.change;return t.relX+=s,[i,s]},[0,0])},Vs=(e,n,t)=>{let r=e.children[n-1],o=e.children[n],i=r,s=r.relX,a=o,c=o.relX,l=!0;for(;i&&a;){i.bottom>t.lowY&&(t=t.next);let u=s+i.prelim-(c+a.prelim)+i.xSize/2+a.xSize/2+i.spacing(a);(u>0||u<0&&l)&&(c+=u,Ws(o,u),Us(e,n,t.index,u)),l=!1;let h=i.bottom,d=a.bottom;h<=d&&(i=Gs(i),i&&(s+=i.relX)),h>=d&&(a=Qs(a),a&&(c+=a.relX))}!i&&a?Js(e,n,a,c):i&&!a&&Zs(e,n,i,s)},Ws=(e,n)=>{e.relX+=n,e.lExtRelX+=n,e.rExtRelX+=n},Us=(e,n,t,r)=>{let o=e.children[n],i=n-t;if(i>1){let s=r/i;e.children[t+1].shift+=s,o.shift-=s,o.change-=r-s}},Qs=e=>e.hasChildren?e.firstChild:e.lThr,Gs=e=>e.hasChildren?e.lastChild:e.rThr,Js=(e,n,t,r)=>{let o=e.firstChild,i=o.lExt,s=e.children[n];i.lThr=t;let a=r-t.relX-o.lExtRelX;i.relX+=a,i.prelim-=a,o.lExt=s.lExt,o.lExtRelX=s.lExtRelX},Zs=(e,n,t,r)=>{let o=e.children[n],i=o.rExt,s=e.children[n-1];i.rThr=t;let a=r-t.relX-o.rExtRelX;i.relX+=a,i.prelim-=a,o.rExt=s.rExt,o.rExtRelX=s.rExtRelX},Ks=e=>{if(e.hasChildren){let n=e.firstChild,t=e.lastChild,r=(n.prelim+n.relX-n.xSize/2+t.relX+t.prelim+t.xSize/2)/2;Object.assign(e,{prelim:r,lExt:n.lExt,lExtRelX:n.lExtRelX,rExt:t.rExt,rExtRelX:t.rExtRelX})}},js=(e,n,t)=>{for(;t!==null&&e>=t.lowY;)t=t.next;return{lowY:e,index:n,next:t}};function cn(e){return function(){return e}}var fn=Math.PI,hn=2*fn,mt=1e-6,tl=hn-mt;function jo(e){this._+=e[0];for(let n=1,t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function el(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return jo;let t=10**n;return function(r){this._+=r[0];for(let o=1,i=r.length;o<i;++o)this._+=Math.round(arguments[o]*t)/t+r[o]}}var gt=class{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?jo:el(n)}moveTo(n,t){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,t){this._append`L${this._x1=+n},${this._y1=+t}`}quadraticCurveTo(n,t,r,o){this._append`Q${+n},${+t},${this._x1=+r},${this._y1=+o}`}bezierCurveTo(n,t,r,o,i,s){this._append`C${+n},${+t},${+r},${+o},${this._x1=+i},${this._y1=+s}`}arcTo(n,t,r,o,i){if(n=+n,t=+t,r=+r,o=+o,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,a=this._y1,c=r-n,l=o-t,u=s-n,h=a-t,d=u*u+h*h;if(this._x1===null)this._append`M${this._x1=n},${this._y1=t}`;else if(d>mt)if(!(Math.abs(h*c-l*u)>mt)||!i)this._append`L${this._x1=n},${this._y1=t}`;else{let p=r-s,g=o-a,y=c*c+l*l,w=p*p+g*g,_=Math.sqrt(y),k=Math.sqrt(d),N=i*Math.tan((fn-Math.acos((y+d-w)/(2*_*k)))/2),B=N/k,z=N/_;Math.abs(B-1)>mt&&this._append`L${n+B*u},${t+B*h}`,this._append`A${i},${i},0,0,${+(h*p>u*g)},${this._x1=n+z*c},${this._y1=t+z*l}`}}arc(n,t,r,o,i,s){if(n=+n,t=+t,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(o),c=r*Math.sin(o),l=n+a,u=t+c,h=1^s,d=s?o-i:i-o;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>mt||Math.abs(this._y1-u)>mt)&&this._append`L${l},${u}`,r&&(d<0&&(d=d%hn+hn),d>tl?this._append`A${r},${r},0,1,${h},${n-a},${t-c}A${r},${r},0,1,${h},${this._x1=l},${this._y1=u}`:d>mt&&this._append`A${r},${r},0,${+(d>=fn)},${h},${this._x1=n+r*Math.cos(i)},${this._y1=t+r*Math.sin(i)}`)}rect(n,t,r,o){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}h${r=+r}v${+o}h${-r}Z`}toString(){return this._}};function ti(){return new gt}ti.prototype=gt.prototype;function ei(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(t==null)n=null;else{let r=Math.floor(t);if(!(r>=0))throw new RangeError(`invalid digits: ${t}`);n=r}return e},()=>new gt(n)}var ni=Array.prototype.slice;function ri(e){return e[0]}function oi(e){return e[1]}var dn=class{constructor(n,t){this._context=n,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,t){switch(n=+n,t=+t,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,t):this._context.moveTo(n,t);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,t,n,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,n,this._y0,n,t);break}}this._x0=n,this._y0=t}};function ii(e){return new dn(e,!0)}function nl(e){return e.source}function rl(e){return e.target}function ai(e){let n=nl,t=rl,r=ri,o=oi,i=null,s=null,a=ei(c);function c(){let l,u=ni.call(arguments),h=n.apply(this,u),d=t.apply(this,u);if(i==null&&(s=e(l=a())),s.lineStart(),u[0]=h,s.point(+r.apply(this,u),+o.apply(this,u)),u[0]=d,s.point(+r.apply(this,u),+o.apply(this,u)),s.lineEnd(),l)return s=null,l+""||null}return c.source=function(l){return arguments.length?(n=l,c):n},c.target=function(l){return arguments.length?(t=l,c):t},c.x=function(l){return arguments.length?(r=typeof l=="function"?l:cn(+l),c):r},c.y=function(l){return arguments.length?(o=typeof l=="function"?l:cn(+l),c):o},c.context=function(l){return arguments.length?(l==null?i=s=null:s=e(i=l),c):i},c}function pn(){return ai(ii)}var T={selection:V,select:D,max:Zt,min:Kt,sum:jt,cumsum:Jt,tree:Ve,stratify:Ye,zoom:un,zoomIdentity:pt,linkHorizontal:pn,flextree:kt},$e=class{constructor(){let n={id:`ID${Math.floor(Math.random()*1e6)}`,firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:t=>t.nodeId||t.id,parentNodeId:t=>t.parentNodeId||t.parentId,rootMargin:40,nodeWidth:t=>250,nodeHeight:t=>150,neighbourMargin:(t,r)=>80,siblingsMargin:t=>20,childrenMargin:t=>60,compactMarginPair:t=>100,compactMarginBetween:t=>20,nodeButtonWidth:t=>40,nodeButtonHeight:t=>40,nodeButtonX:t=>-20,nodeButtonY:t=>-20,linkYOffset:30,pagingStep:t=>5,minPagingVisibleNodes:t=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:t=>T.zoom(),onZoomStart:t=>{},onZoom:t=>{},onZoomEnd:t=>{},onNodeClick:t=>t,onExpandOrCollapse:t=>t,nodeContent:t=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${t.id}), override using <br/> 
            <code>chart.nodeContent({data}=>{ <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>
             })</code>
             <br/> 
             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>
             </div>`,buttonContent:({node:t,state:r})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:i=>i?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                          </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`,bottom:i=>i?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${t.data._directSubordinatesPaging} </span></div>
                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${t.data._directSubordinatesPaging} </span></div>
                    `,right:i=>i?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`,top:i=>i?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${t.data._directSubordinatesPaging} </span></div>
                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${t.data._directSubordinatesPaging} </span></div>
                    `}[r.layout](t.children)}  </div>`,pagingButton:(t,r,o,i)=>{let s=i.pagingStep(t.parent),a=t.parent.data._pagingStep,c=t.parent.data._directSubordinatesPaging-a;return`
                   <div style="margin-top:90px;">
                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">
                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg>
                      </div><div style="line-height:2"> Show next ${Math.min(c,s)}  nodes </div></div>
                   </div>
                `},nodeUpdate:function(t,r,o){T.select(this).select(".node-rect").attr("stroke",i=>i.data._highlighted||i.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",t.data._highlighted||t.data._upToTheRootHighlighted?10:1)},nodeEnter:t=>t,nodeExit:t=>t,linkUpdate:function(t,r,o){T.select(this).attr("stroke",i=>i.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",i=>i.data._upToTheRootHighlighted?5:1),t.data._upToTheRootHighlighted&&T.select(this).raise()},hdiagonal:function(t,r,o){let i=t.x,s=t.y,a=r.x,c=r.y,l=o&&o.x!=null?o.x:i,u=o&&o.y!=null?o.y:s,h=a-i<0?-1:1,d=c-s<0?-1:1,p=35,g=Math.abs(a-i)/2<p?Math.abs(a-i)/2:p;g=Math.abs(c-s)/2<g?Math.abs(c-s)/2:g;let y=Math.abs(c-s)/2-g,w=Math.abs(a-i)/2-g;return`
                          M ${l} ${u}
                          L ${l} ${s}
                          L ${i} ${s}
                          L ${i+w*h} ${s}
                          C ${i+w*h+g*h} ${s} 
                            ${i+w*h+g*h} ${s} 
                            ${i+w*h+g*h} ${s+g*d}
                          L ${i+w*h+g*h} ${c-g*d} 
                          C ${i+w*h+g*h}  ${c} 
                            ${i+w*h+g*h}  ${c} 
                            ${a-w*h}  ${c}
                          L ${a} ${c}
               `},diagonal:function(t,r,o,i={sy:0}){let s=t.x,a=t.y,c=r.x,l=r.y,u=o&&o.x!=null?o.x:s,h=o&&o.y!=null?o.y:a,d=c-s<0?-1:1,p=l-a<0?-1:1;a+=i.sy;let g=35,y=Math.abs(c-s)/2<g?Math.abs(c-s)/2:g;y=Math.abs(l-a)/2<y?Math.abs(l-a)/2:y;let w=Math.abs(l-a)/2-y,_=Math.abs(c-s)-y*2;return`
                          M ${u} ${h}
                          L ${s} ${h}
                          L ${s} ${a}
                          L ${s} ${a+w*p}
                          C  ${s} ${a+w*p+y*p} ${s} ${a+w*p+y*p} ${s+y*d} ${a+w*p+y*p}
                          L ${s+_*d+y*d} ${a+w*p+y*p}
                          C  ${c}  ${a+w*p+y*p} ${c}  ${a+w*p+y*p} ${c} ${l-w*p}
                          L ${c} ${l}
               `},defs:function(t,r){return`<defs>
                    ${r.map(o=>{let i=this.getTextWidth(o.label,{ctx:t.ctx,fontSize:2,defaultFont:t.defaultFont});return`
                       <marker id="${o.from+"_"+o.to}" refX="${o._source.x<o._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${o._source.x<o._target.x?"auto":"auto-start-reverse"}" >
                       <rect rx=0.5 width=${o.label?i+3:0} height=3 y=1  fill="#E27396"></rect>
                       <text font-size="2px" x=1 fill="white" y=3>${o.label||""}</text>
                       </marker>

                       <marker id="arrow-${o.from+"_"+o.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${o._source.x<o._target.x?"auto":"auto-start-reverse"}" >
                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />
                       </marker>
                    `}).join("")}
                    </defs>
                    `},connectionsUpdate:function(t,r,o){T.select(this).attr("stroke",i=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",i=>"5").attr("pointer-events","none").attr("marker-start",i=>`url(#${i.from+"_"+i.to})`).attr("marker-end",i=>`url(#arrow-${i.from+"_"+i.to})`)},linkGroupArc:T.linkHorizontal().x(t=>t.x).y(t=>t.y),layoutBindings:{left:{nodeLeftX:t=>0,nodeRightX:t=>t.width,nodeTopY:t=>-t.height/2,nodeBottomY:t=>t.height/2,nodeJoinX:t=>t.x+t.width,nodeJoinY:t=>t.y-t.height/2,linkJoinX:t=>t.x+t.width,linkJoinY:t=>t.y,linkX:t=>t.x,linkY:t=>t.y,linkCompactXStart:t=>t.x+t.width/2,linkCompactYStart:t=>t.y+(t.compactEven?t.height/2:-t.height/2),compactLinkMidX:(t,r)=>t.firstCompactNode.x,compactLinkMidY:(t,r)=>t.firstCompactNode.y+t.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(t)/4,linkParentX:t=>t.parent.x+t.parent.width,linkParentY:t=>t.parent.y,buttonX:t=>t.width,buttonY:t=>t.height/2,centerTransform:({root:t,rootMargin:r,centerY:o,scale:i,centerX:s})=>`translate(${r},${o}) scale(${i})`,compactDimension:{sizeColumn:t=>t.height,sizeRow:t=>t.width,reverse:t=>t.slice().reverse()},nodeFlexSize:({height:t,width:r,siblingsMargin:o,childrenMargin:i,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[t+o,r+i],zoomTransform:({centerY:t,scale:r})=>`translate(0,${t}) scale(${r})`,diagonal:this.hdiagonal.bind(this),swap:t=>{let r=t.x;t.x=t.y,t.y=r},nodeUpdateTransform:({x:t,y:r,width:o,height:i})=>`translate(${t},${r-i/2})`},top:{nodeLeftX:t=>-t.width/2,nodeRightX:t=>t.width/2,nodeTopY:t=>0,nodeBottomY:t=>t.height,nodeJoinX:t=>t.x-t.width/2,nodeJoinY:t=>t.y+t.height,linkJoinX:t=>t.x,linkJoinY:t=>t.y+t.height,linkCompactXStart:t=>t.x+(t.compactEven?t.width/2:-t.width/2),linkCompactYStart:t=>t.y+t.height/2,compactLinkMidX:(t,r)=>t.firstCompactNode.x+t.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(t)/4,compactLinkMidY:t=>t.firstCompactNode.y,compactDimension:{sizeColumn:t=>t.width,sizeRow:t=>t.height,reverse:t=>t},linkX:t=>t.x,linkY:t=>t.y,linkParentX:t=>t.parent.x,linkParentY:t=>t.parent.y+t.parent.height,buttonX:t=>t.width/2,buttonY:t=>t.height,centerTransform:({root:t,rootMargin:r,centerY:o,scale:i,centerX:s})=>`translate(${s},${r}) scale(${i})`,nodeFlexSize:({height:t,width:r,siblingsMargin:o,childrenMargin:i,state:s,node:a,compactViewIndex:c})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[r+o,t+i],zoomTransform:({centerX:t,scale:r})=>`translate(${t},0}) scale(${r})`,diagonal:this.diagonal.bind(this),swap:t=>{},nodeUpdateTransform:({x:t,y:r,width:o,height:i})=>`translate(${t-o/2},${r})`},bottom:{nodeLeftX:t=>-t.width/2,nodeRightX:t=>t.width/2,nodeTopY:t=>-t.height,nodeBottomY:t=>0,nodeJoinX:t=>t.x-t.width/2,nodeJoinY:t=>t.y-t.height-t.height,linkJoinX:t=>t.x,linkJoinY:t=>t.y-t.height,linkCompactXStart:t=>t.x+(t.compactEven?t.width/2:-t.width/2),linkCompactYStart:t=>t.y-t.height/2,compactLinkMidX:(t,r)=>t.firstCompactNode.x+t.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(t)/4,compactLinkMidY:t=>t.firstCompactNode.y,linkX:t=>t.x,linkY:t=>t.y,compactDimension:{sizeColumn:t=>t.width,sizeRow:t=>t.height,reverse:t=>t},linkParentX:t=>t.parent.x,linkParentY:t=>t.parent.y-t.parent.height,buttonX:t=>t.width/2,buttonY:t=>0,centerTransform:({root:t,rootMargin:r,centerY:o,scale:i,centerX:s,chartHeight:a})=>`translate(${s},${a-r}) scale(${i})`,nodeFlexSize:({height:t,width:r,siblingsMargin:o,childrenMargin:i,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[r+o,t+i],zoomTransform:({centerX:t,scale:r})=>`translate(${t},0}) scale(${r})`,diagonal:this.diagonal.bind(this),swap:t=>{t.y=-t.y},nodeUpdateTransform:({x:t,y:r,width:o,height:i})=>`translate(${t-o/2},${r-i})`},right:{nodeLeftX:t=>-t.width,nodeRightX:t=>0,nodeTopY:t=>-t.height/2,nodeBottomY:t=>t.height/2,nodeJoinX:t=>t.x-t.width-t.width,nodeJoinY:t=>t.y-t.height/2,linkJoinX:t=>t.x-t.width,linkJoinY:t=>t.y,linkX:t=>t.x,linkY:t=>t.y,linkParentX:t=>t.parent.x-t.parent.width,linkParentY:t=>t.parent.y,buttonX:t=>0,buttonY:t=>t.height/2,linkCompactXStart:t=>t.x-t.width/2,linkCompactYStart:t=>t.y+(t.compactEven?t.height/2:-t.height/2),compactLinkMidX:(t,r)=>t.firstCompactNode.x,compactLinkMidY:(t,r)=>t.firstCompactNode.y+t.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(t)/4,centerTransform:({root:t,rootMargin:r,centerY:o,scale:i,centerX:s,chartWidth:a})=>`translate(${a-r},${o}) scale(${i})`,nodeFlexSize:({height:t,width:r,siblingsMargin:o,childrenMargin:i,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[t+o,r+i],compactDimension:{sizeColumn:t=>t.height,sizeRow:t=>t.width,reverse:t=>t.slice().reverse()},zoomTransform:({centerY:t,scale:r})=>`translate(0,${t}) scale(${r})`,diagonal:this.hdiagonal.bind(this),swap:t=>{let r=t.x;t.x=-t.y,t.y=r},nodeUpdateTransform:({x:t,y:r,width:o,height:i})=>`translate(${t-o},${r-i/2})`}}};this.getChartState=()=>n,Object.keys(n).forEach(t=>{this[t]=function(r){if(arguments.length)n[t]=r;else return n[t];return this}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){T.selection.prototype.patternify=function(n){var t=this,r=n.selector,o=n.tag,i=n.data||[r],s=t.selectAll("."+r).data(i,(a,c)=>typeof a=="object"&&a.id?a.id:c);return s.exit().remove(),s=s.enter().append(o).merge(s),s.attr("class",r),s}}getNodeChildren({data:n,children:t,_children:r},o){return o.push(n),t&&t.forEach(i=>{this.getNodeChildren(i,o)}),r&&r.forEach(i=>{this.getNodeChildren(i,o)}),o}initialZoom(n){let t=this.getChartState();return t.lastTransform.k=n,this}render(){let n=this.getChartState();if(!n.data||n.data.length==0)return console.log("ORG CHART - Data is empty"),n.container&&(D(n.container).select(".nodes-wrapper").remove(),D(n.container).select(".links-wrapper").remove(),D(n.container).select(".connections-wrapper").remove()),this;let t=T.select(n.container),r=t.node().getBoundingClientRect();r.width>0&&(n.svgWidth=r.width);let o={id:`ID${Math.floor(Math.random()*1e6)}`,chartWidth:n.svgWidth,chartHeight:n.svgHeight};if(n.calc=o,o.centerX=o.chartWidth/2,o.centerY=o.chartHeight/2,n.firstDraw){let a={zoom:null};a.zoom=n.createZoom().clickDistance(10).on("start",(c,l)=>n.onZoomStart(c)).on("end",(c,l)=>n.onZoomEnd(c)).on("zoom",(c,l)=>{n.onZoom(c),this.zoomed(c,l)}).scaleExtent(n.scaleExtent),n.zoomBehavior=a.zoom}n.flexTreeLayout=kt({nodeSize:a=>{let c=n.nodeWidth(a),l=n.nodeHeight(a),u=n.siblingsMargin(a),h=n.childrenMargin(a);return n.layoutBindings[n.layout].nodeFlexSize({state:n,node:a,width:c,height:l,siblingsMargin:u,childrenMargin:h})}}).spacing((a,c)=>a.parent==c.parent?0:n.neighbourMargin(a,c)),this.setLayouts({expandNodesFirst:!1});let i=t.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",n.svgWidth).attr("height",n.svgHeight).attr("font-family",n.defaultFont);n.firstDraw&&i.call(n.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),n.svg=i;let s=i.patternify({tag:"g",selector:"chart"});return n.centerG=s.patternify({tag:"g",selector:"center-group"}),n.linksWrapper=n.centerG.patternify({tag:"g",selector:"links-wrapper"}),n.nodesWrapper=n.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),n.connectionsWrapper=n.centerG.patternify({tag:"g",selector:"connections-wrapper"}),n.defsWrapper=i.patternify({tag:"g",selector:"defs-wrapper"}),n.firstDraw&&n.centerG.attr("transform",()=>n.layoutBindings[n.layout].centerTransform({centerX:o.centerX,centerY:o.centerY,scale:n.lastTransform.k,rootMargin:n.rootMargin,root:n.root,chartHeight:o.chartHeight,chartWidth:o.chartWidth})),n.chart=s,this.update(n.root),T.select(window).on(`resize.${n.id}`,()=>{let a=T.select(n.container).node().getBoundingClientRect();n.svg.attr("width",a.width)}),n.firstDraw&&(n.firstDraw=!1),this}addNode(n){let t=this.getChartState();if(n&&(t.parentNodeId(n)==null||t.parentNodeId(n)==t.nodeId(n))&&t.data.length==0)return t.data.push(n),this.render(),this;let o=t.generateRoot(t.data).descendants(),i=o.filter(({data:a})=>t.nodeId(a).toString()===t.nodeId(n).toString())[0],s=o.filter(({data:a})=>t.nodeId(a).toString()===t.parentNodeId(n).toString())[0];return i?(console.log(`ORG CHART - ADD - Node with id "${t.nodeId(n)}" already exists in tree`),this):(n._centered&&!n._expanded&&(n._expanded=!0),t.data.push(n),this.updateNodesState(),this)}removeNode(n){let t=this.getChartState(),i=t.generateRoot(t.data).descendants().filter(({data:a})=>t.nodeId(a)==n)[0];return i?(i.descendants().forEach(a=>a.data._filteredOut=!0),t.data=t.data.filter(a=>!a._filteredOut),t.data.length==0?this.render():this.updateNodesState.bind(this)(),this):(console.log(`ORG CHART - REMOVE - Node with id "${n}" not found in the tree`),this)}groupBy(n,t,r){let o={};return n.forEach(i=>{let s=t(i);o[s]||(o[s]=[]),o[s].push(i)}),Object.keys(o).forEach(i=>{o[i]=r(o[i])}),Object.entries(o)}calculateCompactFlexDimensions(n){let t=this.getChartState();n.eachBefore(r=>{r.firstCompact=null,r.compactEven=null,r.flexCompactDim=null,r.firstCompactNode=null}),n.eachBefore(r=>{if(r.children&&r.children.length>1){let o=r.children.filter(u=>!u.children);if(o.length<2)return;o.forEach((u,h)=>{h||(u.firstCompact=!0),h%2?u.compactEven=!1:u.compactEven=!0,u.row=Math.floor(h/2)});let i=T.max(o.filter(u=>u.compactEven),t.layoutBindings[t.layout].compactDimension.sizeColumn),s=T.max(o.filter(u=>!u.compactEven),t.layoutBindings[t.layout].compactDimension.sizeColumn),a=Math.max(i,s)*2,c=this.groupBy(o,u=>u.row,u=>T.max(u,h=>t.layoutBindings[t.layout].compactDimension.sizeRow(h)+t.compactMarginBetween(h))),l=T.sum(c.map(u=>u[1]));o.forEach(u=>{u.firstCompactNode=o[0],u.firstCompact?u.flexCompactDim=[a+t.compactMarginPair(u),l-t.compactMarginBetween(u)]:u.flexCompactDim=[0,0]}),r.flexCompactDim=null}})}calculateCompactFlexPositions(n){let t=this.getChartState();n.eachBefore(r=>{if(r.children){let o=r.children.filter(u=>u.flexCompactDim),i=o[0];if(!i)return;o.forEach((u,h,d)=>{h==0&&(i.x-=i.flexCompactDim[0]/2),h&h%2-1?u.x=i.x+i.flexCompactDim[0]*.25-t.compactMarginPair(u)/4:h&&(u.x=i.x+i.flexCompactDim[0]*.75+t.compactMarginPair(u)/4)});let s=i.x+i.flexCompactDim[0]*.5;i.x=i.x+i.flexCompactDim[0]*.25-t.compactMarginPair(i)/4;let a=r.x-s;Math.abs(a)<10&&o.forEach(u=>u.x+=a);let c=this.groupBy(o,u=>u.row,u=>T.max(u,h=>t.layoutBindings[t.layout].compactDimension.sizeRow(h))),l=T.cumsum(c.map(u=>u[1]+t.compactMarginBetween(u)));o.forEach((u,h)=>{u.row?u.y=i.y+l[u.row-1]:u.y=i.y})}})}update({x0:n,y0:t,x:r=0,y:o=0,width:i,height:s}){let a=this.getChartState(),c=a.calc;a.compact&&this.calculateCompactFlexDimensions(a.root);let l=a.flexTreeLayout(a.root);a.compact&&this.calculateCompactFlexPositions(a.root);let u=l.descendants(),h=l.descendants().slice(1);u.forEach(a.layoutBindings[a.layout].swap);let d=a.connections,p={};a.allNodes.forEach(f=>p[a.nodeId(f.data)]=f);let g={};u.forEach(f=>g[a.nodeId(f.data)]=f),d.forEach(f=>{let v=p[f.from],C=p[f.to];f._source=v,f._target=C});let y=d.filter(f=>g[f.from]&&g[f.to]),w=a.defs.bind(this)(a,y),_=a.defsWrapper.html();w!==_&&a.defsWrapper.html(w);let k=a.linksWrapper.selectAll("path.link").data(h,f=>a.nodeId(f.data)),B=k.enter().insert("path","g").attr("class","link").attr("d",f=>{let v=a.layoutBindings[a.layout].linkJoinX({x:n,y:t,width:i,height:s}),C=a.layoutBindings[a.layout].linkJoinY({x:n,y:t,width:i,height:s}),$={x:v,y:C};return a.layoutBindings[a.layout].diagonal($,$,$)}).merge(k);B.attr("fill","none"),this.isEdge()?B.style("display",f=>f.data._pagingButton?"none":"auto"):B.attr("display",f=>f.data._pagingButton?"none":"auto"),B.each(a.linkUpdate),B.transition().duration(a.duration).attr("d",f=>{let v=a.compact&&f.flexCompactDim?{x:a.layoutBindings[a.layout].compactLinkMidX(f,a),y:a.layoutBindings[a.layout].compactLinkMidY(f,a)}:{x:a.layoutBindings[a.layout].linkX(f),y:a.layoutBindings[a.layout].linkY(f)},C={x:a.layoutBindings[a.layout].linkParentX(f),y:a.layoutBindings[a.layout].linkParentY(f)},$=a.compact&&f.flexCompactDim?{x:a.layoutBindings[a.layout].linkCompactXStart(f),y:a.layoutBindings[a.layout].linkCompactYStart(f)}:v;return a.layoutBindings[a.layout].diagonal(v,C,$,{sy:a.linkYOffset})});let z=k.exit().transition().duration(a.duration).attr("d",f=>{let v=a.layoutBindings[a.layout].linkJoinX({x:r,y:o,width:i,height:s}),C=a.layoutBindings[a.layout].linkJoinY({x:r,y:o,width:i,height:s}),$={x:v,y:C};return a.layoutBindings[a.layout].diagonal($,$,null,{sy:a.linkYOffset})}).remove(),X=a.connectionsWrapper.selectAll("path.connection").data(y),et=X.enter().insert("path","g").attr("class","connection").attr("d",f=>{let v=a.layoutBindings[a.layout].linkJoinX({x:n,y:t,width:i,height:s}),C=a.layoutBindings[a.layout].linkJoinY({x:n,y:t,width:i,height:s}),$={x:v,y:C};return a.layoutBindings[a.layout].diagonal($,$,null,{sy:a.linkYOffset})}).merge(X);et.attr("fill","none"),et.transition().duration(a.duration).attr("d",f=>{let v=a.layoutBindings[a.layout].linkX({x:f._source.x,y:f._source.y,width:f._source.width,height:f._source.height}),C=a.layoutBindings[a.layout].linkY({x:f._source.x,y:f._source.y,width:f._source.width,height:f._source.height}),$=a.layoutBindings[a.layout].linkJoinX({x:f._target.x,y:f._target.y,width:f._target.width,height:f._target.height}),I=a.layoutBindings[a.layout].linkJoinY({x:f._target.x,y:f._target.y,width:f._target.width,height:f._target.height});return a.linkGroupArc({source:{x:v,y:C},target:{x:$,y:I}})}),et.each(a.connectionsUpdate);let St=X.exit().transition().duration(a.duration).attr("opacity",0).remove(),nt=a.nodesWrapper.selectAll("g.node").data(u,({data:f})=>a.nodeId(f)),xt=nt.enter().append("g").attr("class","node").attr("transform",f=>{if(f==a.root)return`translate(${n},${t})`;let v=a.layoutBindings[a.layout].nodeJoinX({x:n,y:t,width:i,height:s}),C=a.layoutBindings[a.layout].nodeJoinY({x:n,y:t,width:i,height:s});return`translate(${v},${C})`}).attr("cursor","pointer").on("click.node",(f,v)=>{let{data:C}=v;if(![...f.srcElement.classList].includes("node-button-foreign-object")){if([...f.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(v);return}if(!C._pagingButton){a.onNodeClick(v);return}console.log("event fired, no handlers")}}).on("keydown.node",(f,v)=>{let{data:C}=v;if(f.key==="Enter"||f.key===" "||f.key==="Spacebar"){if([...f.srcElement.classList].includes("node-button-foreign-object"))return;if([...f.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(v);return}(f.key==="Enter"||f.key===" "||f.key==="Spacebar")&&this.onButtonClick(f,v)}});xt.each(a.nodeEnter),xt.patternify({tag:"rect",selector:"node-rect",data:f=>[f]});let G=xt.merge(nt).style("font","12px sans-serif");G.patternify({tag:"foreignObject",selector:"node-foreign-object",data:f=>[f]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:f=>[f]}),this.restyleForeignObjectElements();let m=xt.patternify({tag:"g",selector:"node-button-g",data:f=>[f]}).on("click",(f,v)=>this.onButtonClick(f,v)).on("keydown",(f,v)=>{(f.key==="Enter"||f.key===" "||f.key==="Spacebar")&&this.onButtonClick(f,v)});m.patternify({tag:"rect",selector:"node-button-rect",data:f=>[f]}).attr("opacity",0).attr("pointer-events","all").attr("width",f=>a.nodeButtonWidth(f)).attr("height",f=>a.nodeButtonHeight(f)).attr("x",f=>a.nodeButtonX(f)).attr("y",f=>a.nodeButtonY(f));let b=m.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:f=>[f]}).attr("width",f=>a.nodeButtonWidth(f)).attr("height",f=>a.nodeButtonHeight(f)).attr("x",f=>a.nodeButtonX(f)).attr("y",f=>a.nodeButtonY(f)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:f=>[f]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%");G.transition().attr("opacity",0).duration(a.duration).attr("transform",({x:f,y:v,width:C,height:$})=>a.layoutBindings[a.layout].nodeUpdateTransform({x:f,y:v,width:C,height:$})).attr("opacity",1),G.select(".node-rect").attr("width",({width:f})=>f).attr("height",({height:f})=>f).attr("x",({width:f})=>0).attr("y",({height:f})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",a.nodeDefaultBackground),G.select(".node-button-g").attr("transform",({data:f,width:v,height:C})=>{let $=a.layoutBindings[a.layout].buttonX({width:v,height:C}),I=a.layoutBindings[a.layout].buttonY({width:v,height:C});return`translate(${$},${I})`}).attr("display",({data:f})=>f._directSubordinates>0?null:"none").attr("opacity",({data:f,children:v,_children:C})=>f._pagingButton?0:v||C?1:0),G.select(".node-button-foreign-object .node-button-div").html(f=>a.buttonContent({node:f,state:a})),G.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:f})=>f?40:26).text(({children:f})=>f?"-":"+").attr("y",this.isEdge()?10:0),G.each(a.nodeUpdate);let x=nt.exit();x.each(a.nodeExit);let E=x.data().reduce((f,v)=>f.depth<v.depth?f:v,{depth:1/0});x.attr("opacity",1).transition().duration(a.duration).attr("transform",f=>{let{x:v,y:C,width:$,height:I}=E.parent||{},M=a.layoutBindings[a.layout].nodeJoinX({x:v,y:C,width:$,height:I}),Y=a.layoutBindings[a.layout].nodeJoinY({x:v,y:C,width:$,height:I});return`translate(${M},${Y})`}).on("end",function(){T.select(this).remove()}).attr("opacity",0),u.forEach(f=>{f.x0=f.x,f.y0=f.y});let S=a.allNodes.filter(f=>f.data._centered)[0];if(S){let f=[S];S.data._centeredWithDescendants&&(a.compact?f=S.descendants().filter((v,C)=>C<7):f=S.descendants().filter((v,C,$)=>{let I=Math.round($.length/2),M=2;return $.length%2?C>I-M&&C<I+M-1:C>I-M&&C<I+M})),S.data._centeredWithDescendants=null,S.data._centered=null,this.fit({animate:!0,scale:!1,nodes:f})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(n,t,r,o){return this.getChartState().hdiagonal(n,t,r,o)}diagonal(n,t,r,o){return this.getChartState().diagonal(n,t,r,o)}restyleForeignObjectElements(){let n=this.getChartState();n.svg.selectAll(".node-foreign-object").attr("width",({width:t})=>t).attr("height",({height:t})=>t).attr("x",({width:t})=>0).attr("y",({height:t})=>0),n.svg.selectAll(".node-foreign-object-div").style("width",({width:t})=>`${t}px`).style("height",({height:t})=>`${t}px`).html(function(t,r,o){return t.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${n.pagingButton(t,r,o,n)}</div></div>`:n.nodeContent.bind(this)(t,r,o,n)})}onButtonClick(n,t){let r=this.getChartState();t.data._pagingButton||(r.setActiveNodeCentered&&(t.data._centered=!0,t.data._centeredWithDescendants=!0),t.children?(t._children=t.children,t.children=null,this.setExpansionFlagToChildren(t,!1)):(t.children=t._children,t._children=null,t.children&&t.children.forEach(({data:o})=>o._expanded=!0)),this.update(t),n.stopPropagation(),r.onExpandOrCollapse(t))}setExpansionFlagToChildren({data:n,children:t,_children:r},o){n._expanded=o,t&&t.forEach(i=>{this.setExpansionFlagToChildren(i,o)}),r&&r.forEach(i=>{this.setExpansionFlagToChildren(i,o)})}expandSomeNodes(n){if(n.data._expanded){let t=n.parent;for(;t&&t._children;)t.children=t._children,t._children=null,t=t.parent}n._children&&n._children.forEach(t=>this.expandSomeNodes(t)),n.children&&n.children.forEach(t=>this.expandSomeNodes(t))}updateNodesState(){let n=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(n.root)}setLayouts({expandNodesFirst:n=!0}){let t=this.getChartState();t.generateRoot=T.stratify().id(i=>t.nodeId(i)).parentId(i=>t.parentNodeId(i)),t.root=t.generateRoot(t.data);let r=t.root.descendants();t.initialExpandLevel>1&&r.length>0&&(r.forEach(i=>{i.depth<=t.initialExpandLevel&&(i.data._expanded=!0)}),t.initialExpandLevel=1);let o={};t.root.descendants().filter(i=>i.children).filter(i=>!i.data._pagingStep).forEach(i=>{i.data._pagingStep=t.minPagingVisibleNodes(i)}),t.root.eachBefore((i,s)=>{i.data._directSubordinatesPaging=i.children?i.children.length:0,i.children&&i.children.forEach((a,c)=>{if(a.data._pagingButton=!1,c>i.data._pagingStep&&(o[a.id]=!0),c===i.data._pagingStep&&i.children.length-1>i.data._pagingStep&&(a.data._pagingButton=!0),o[a.parent.id]&&(o[a.id]=!0),a.data._expanded||a.data._centered||a.data._highlighted||a.data._upToTheRootHighlighted){let l=a;for(;l&&(o[l.id]||l.data._pagingButton);)o[l.id]=!1,l.data._pagingButton&&(l.data._pagingButton=!1,l.parent.children.forEach(u=>{u.data._expanded=!0,o[u.id]=!1})),l=l.parent}})}),t.root=T.stratify().id(i=>t.nodeId(i)).parentId(i=>t.parentNodeId(i))(t.data.filter(i=>o[i.id]!==!0)),t.root.each((i,s,a)=>{let c=i._hierarchyHeight||i.height,l=t.nodeWidth(i),u=t.nodeHeight(i);Object.assign(i,{width:l,height:u,_hierarchyHeight:c})}),t.root.x0=0,t.root.y0=0,t.allNodes=t.root.descendants(),t.allNodes.forEach(i=>{Object.assign(i.data,{_directSubordinates:i.children?i.children.length:0,_totalSubordinates:i.descendants().length-1})}),t.root.children&&(n&&t.root.children.forEach(this.expand),t.root.children.forEach(i=>this.collapse(i)),t.initialExpandLevel==0&&(t.root._children=t.root.children,t.root.children=null),[t.root].forEach(i=>this.expandSomeNodes(i)))}collapse(n){n.children&&(n._children=n.children,n._children.forEach(t=>this.collapse(t)),n.children=null)}expand(n){n._children&&(n.children=n._children,n.children.forEach(t=>this.expand(t)),n._children=null)}zoomed(n,t){let r=this.getChartState(),o=r.chart,i=n.transform;r.lastTransform=i,o.attr("transform",i),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:n,x1:t,y0:r,y1:o,params:i={animate:!0,scale:!0,onCompleted:()=>{}}}){let{centerG:s,svgWidth:a,svgHeight:c,svg:l,zoomBehavior:u,duration:h,lastTransform:d}=this.getChartState(),p=Math.min(8,.9/Math.max((t-n)/a,(o-r)/c)),g=T.zoomIdentity.translate(a/2,c/2);g=g.scale(i.scale?p:d.k),g=g.translate(-(n+t)/2,-(r+o)/2),l.transition().duration(i.animate?h:0).call(u.transform,g),s.transition().duration(i.animate?h:0).attr("transform","translate(0,0)").on("end",function(){i.onCompleted&&i.onCompleted()})}fit({animate:n=!0,nodes:t,scale:r=!0,onCompleted:o=()=>{}}={}){let i=this.getChartState(),{root:s}=i,a=t||s.descendants(),c=T.min(a,d=>d.x+i.layoutBindings[i.layout].nodeLeftX(d)),l=T.max(a,d=>d.x+i.layoutBindings[i.layout].nodeRightX(d)),u=T.min(a,d=>d.y+i.layoutBindings[i.layout].nodeTopY(d)),h=T.max(a,d=>d.y+i.layoutBindings[i.layout].nodeBottomY(d));return this.zoomTreeBounds({params:{animate:n,scale:r,onCompleted:o},x0:c-50,x1:l+50,y0:u-50,y1:h+50}),this}loadPagingNodes(n){let t=this.getChartState();n.data._pagingButton=!1;let r=n.parent.data._pagingStep,o=t.pagingStep(n.parent),i=r+o;n.parent.data._pagingStep=i,this.updateNodesState()}setExpanded(n,t=!0){let r=this.getChartState(),o=r.allNodes.filter(({data:i})=>r.nodeId(i)==n)[0];if(!o)return console.log(`ORG CHART - ${t?"EXPAND":"COLLAPSE"} - Node with id (${n})  not found in the tree`),this;if(o.data._expanded=t,t==!1){let i=o.parent||{descendants:()=>[]};i.descendants().filter(a=>a!=i).forEach(a=>a.data._expanded=!1)}return this}setCentered(n){let t=this.getChartState(),i=t.generateRoot(t.data).descendants().filter(({data:a})=>t.nodeId(a).toString()==n.toString())[0];return i?(i.ancestors().forEach(a=>a.data._expanded=!0),i.data._centered=!0,i.data._expanded=!0,this):(console.log(`ORG CHART - CENTER - Node with id (${n}) not found in the tree`),this)}setHighlighted(n){let t=this.getChartState(),i=t.generateRoot(t.data).descendants().filter(a=>t.nodeId(a.data).toString()===n.toString())[0];return i?(i.ancestors().forEach(a=>a.data._expanded=!0),i.data._highlighted=!0,i.data._expanded=!0,i.data._centered=!0,this):(console.log(`ORG CHART - HIGHLIGHT - Node with id (${n})  not found in the tree`),this)}setUpToTheRootHighlighted(n){let t=this.getChartState(),i=t.generateRoot(t.data).descendants().filter(a=>t.nodeId(a.data).toString()===n.toString())[0];return i?(i.ancestors().forEach(a=>a.data._expanded=!0),i.data._upToTheRootHighlighted=!0,i.data._expanded=!0,i.ancestors().forEach(a=>a.data._upToTheRootHighlighted=!0),this):(console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${n}) not found in the tree`),this)}clearHighlighting(){let n=this.getChartState();return n.allNodes.forEach(t=>{t.data._highlighted=!1,t.data._upToTheRootHighlighted=!1}),this.update(n.root),this}fullscreen(n){let t=this.getChartState(),r=T.select(n||t.container).node();T.select(document).on("fullscreenchange."+t.id,function(o){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==r?setTimeout(s=>{t.svg.attr("height",window.innerHeight-40)},500):t.svg.attr("height",t.svgHeight)}),r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen?r.webkitRequestFullscreen():r.msRequestFullscreen&&r.msRequestFullscreen()}zoomIn(){let{svg:n,zoomBehavior:t}=this.getChartState();n.transition().call(t.scaleBy,1.3)}zoomOut(){let{svg:n,zoomBehavior:t}=this.getChartState();n.transition().call(t.scaleBy,.78)}toDataURL(n,t){var r=new XMLHttpRequest;r.onload=function(){var o=new FileReader;o.onloadend=function(){t(o.result)},o.readAsDataURL(r.response)},r.open("GET",n),r.responseType="blob",r.send()}exportImg({full:n=!1,scale:t=3,onLoad:r=s=>s,save:o=!0,backgroundColor:i="#FAFAFA"}={}){let s=this,a=this.getChartState(),{svg:c,root:l}=a,u=0,h=c.selectAll("img"),d=h.size(),p=()=>{let g=JSON.parse(JSON.stringify(s.lastTransform())),y=s.duration();n&&s.fit();let{svg:w}=s.getChartState();setTimeout(_=>{s.downloadImage({node:w.node(),scale:t,isSvg:!1,backgroundColor:i,onAlreadySerialized:k=>{s.update(l)},imageName:a.imageName,onLoad:r,save:o})},n?y+10:0)};d>0?h.each(function(){s.toDataURL(this.src,g=>{this.src=g,++u==d&&p()})}):p()}exportSvg(){let{svg:n,imageName:t}=this.getChartState();return this.downloadImage({imageName:t,node:n.node(),scale:3,isSvg:!0}),this}expandAll(){let{allNodes:n,root:t,data:r}=this.getChartState();return r.forEach(o=>o._expanded=!0),this.render(),this}collapseAll(){let{allNodes:n,root:t}=this.getChartState();return n.forEach(r=>r.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:n,scale:t=2,imageName:r="graph",isSvg:o=!1,save:i=!0,backgroundColor:s="#FAFAFA",onAlreadySerialized:a=l=>{},onLoad:c=l=>{}}){let l=n;function u(y,w){var _=document.createElement("a");typeof _.download=="string"?(document.body.appendChild(_),_.download=w,_.href=y,_.click(),document.body.removeChild(_)):location.replace(y)}function h(y){let w="http://www.w3.org/2000/xmlns/",_="http://www.w3.org/1999/xlink",k="http://www.w3.org/2000/svg";y=y.cloneNode(!0);let N=window.location.href+"#",B=document.createTreeWalker(y,NodeFilter.SHOW_ELEMENT,null,!1);for(;B.nextNode();)for(let H of B.currentNode.attributes)H.value.includes(N)&&(H.value=H.value.replace(N,"#"));return y.setAttributeNS(w,"xmlns",k),y.setAttributeNS(w,"xmlns:xlink",_),new XMLSerializer().serializeToString(y)}if(o){let y=h(l);y=`<?xml version="1.0" standalone="no"?>\r
`+y;var g="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(y);u(g,r+".svg"),a();return}let d=t,p=document.createElement("img");p.onload=function(){let y=document.createElement("canvas"),w=l.getBoundingClientRect();y.width=w.width*d,y.height=w.height*d;let _=y.getContext("2d");_.fillStyle=s,_.fillRect(0,0,w.width*d,w.height*d),_.drawImage(p,0,0,w.width*d,w.height*d);let k=y.toDataURL("image/png");c&&c(k),i&&u(k,r+".png")};var g="data:image/svg+xml; charset=utf8, "+encodeURIComponent(h(l));a(),p.src=g}getTextWidth(n,{fontSize:t=14,fontWeight:r=400,defaultFont:o="Helvetice",ctx:i}={}){return i.font=`${r||""} ${t}px ${o} `,i.measureText(n).width}clear(){let n=this.getChartState();T.select(window).on(`resize.${n.id}`,null),n.svg&&n.svg.selectAll("*").remove()}};var si=(()=>{class e{constructor(t){this._HttpClient=t}getSpecificProtocol(t){return this._HttpClient.get(`${An}getSpecificProtocol/${t}`)}static{this.\u0275fac=function(r){return new(r||e)(xn(zn))}}static{this.\u0275prov=gn({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var al=["chartContainer"];function sl(e,n){if(e&1){let t=bn();lt(0,"div",9)(1,"div",10)(2,"input",11),En("change",function(){let o=_n(t).$implicit,i=Ie().$implicit,s=Ie();return s.onCheckPreviousQuestionCheck(i),vn(s.onDisplayNextQuestionChange(o,i))}),yt(),lt(3,"label",12),Bn(4),yt()()()}if(e&2){let t=n.$implicit;st(2),qt("id",t.id)("value",t.next_question_id)("name",t.question_id),st(),qt("for",t.id),st(),Nn(t.text)}}function ll(e,n){if(e&1&&(lt(0,"div",6)(1,"div",7),ze(2,"div",8),lt(3,"form"),Te(4,sl,5,5,"div",9,Ne),yt()()()),e&2){let t=n.$implicit;st(2),qt("innerHTML",t.description,Cn),st(2),Me(t.choices)}}var Nm=(()=>{class e{constructor(t,r,o){this._ActivatedRoute=t,this._SpecificProtocolService=r,this.platformId=o,this.currentQuestionArr=[]}ngOnInit(){this.handleGetCurrentCategoryId(),this.getCurrentCategory()}handleGetCurrentCategoryId(){this._ActivatedRoute.paramMap.subscribe({next:t=>{this.protocolId=t.get("id")}})}getCurrentCategory(){this._SpecificProtocolService.getSpecificProtocol(this.protocolId).subscribe({next:t=>{this.specificProtocol=t,this.displayFirstQuestion()},error:t=>{console.log(t)}})}renderChart(){if(Mn(this.platformId)){let t=this.getChartData();this.orgChart||(this.orgChart=new $e().container(this.chartContainer.nativeElement).nodeWidth(()=>200).nodeHeight(()=>80).nodeContent(r=>this.getCustomNodeHTML(r)).onNodeClick(r=>console.log("Node clicked:",r))),this.orgChart.data(t).render(),t.forEach(r=>this.orgChart.expand(r.id)),this.orgChart.fit()}}getChartData(){return this.currentQuestionArr.map((t,r)=>({id:t.id,name:t.text,title:`Question ${r+1}`,parentId:r>0?this.currentQuestionArr[r-1].id:null}))}getCustomNodeHTML(t){return`
      <div class="custom-node">
        <div class="node-header" style="background-color: #4CAF50; color: white; padding: 10px;">
          ${t.data.name}
        </div>
        <div class="node-subtitle" style="padding: 5px; font-size: 12px;">
          ${t.data.title}
        </div>
      </div>
    `}displayFirstQuestion(){let t=this.specificProtocol.protocol.questions[0];this.currentQuestionArr.push(t),this.renderChart()}onDisplayNextQuestionChange(t,r){let o=this.specificProtocol.protocol.questions.find(i=>i.id===t.next_question_id);o&&(this.currentQuestionArr.push(o),this.renderChart())}onCheckPreviousQuestionCheck(t){let r=this.currentQuestionArr.indexOf(t);r!==-1&&(this.currentQuestionArr.splice(r+1),this.renderChart())}static{this.\u0275fac=function(r){return new(r||e)(Ft(In),Ft(si),Ft(wn))}}static{this.\u0275cmp=yn({type:e,selectors:[["app-protocol-questions"]],viewQuery:function(r,o){if(r&1&&kn(al,7),r&2){let i;Sn(i=$n())&&(o.chartContainer=i.first)}},standalone:!0,features:[Tn],decls:11,vars:0,consts:[["chartContainer",""],[1,"container-fluid","ProtoCol__Container"],[1,"row"],[1,"col-8"],[1,"chart-container","h-100"],[1,"col-4"],["id","Questions__Description",1,"card","mb-2"],[1,"card-body"],[3,"innerHTML"],["id","Questions__Choces"],[1,"form-check"],["type","radio",1,"form-check-input",3,"change","id","value","name"],[1,"form-check-label",3,"for"]],template:function(r,o){r&1&&(lt(0,"div",1)(1,"div",2)(2,"div",3)(3,"div"),ze(4,"div",4,0),yt()(),lt(6,"div",5)(7,"div")(8,"div"),Te(9,ll,6,1,"div",6,Ne),yt()()()()()),r&2&&(st(9),Me(o.currentQuestionArr))},styles:['.ProtoCol__Container[_ngcontent-%COMP%]{padding-top:200px}.chart-container[_ngcontent-%COMP%]{width:100%;height:600px;overflow:hidden;border:1px solid #ccc}  .custom-node{border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 8px #0000001a;text-align:center;font-family:"Arial, sans-serif"}  .custom-node .node-header{font-weight:700;font-size:14px;border-bottom:1px solid #ddd}  .custom-node .node-subtitle{font-size:12px;color:#555}  .custom-node.active{border:2px solid #4caf50;background-color:#e8f5e9}']})}}return e})();export{Nm as ProtocolQuestionsComponent};
