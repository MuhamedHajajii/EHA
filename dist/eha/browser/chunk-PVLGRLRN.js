import{a as W,b as X}from"./chunk-KPBD4K6Y.js";import{a as Z}from"./chunk-SC5KS6LP.js";import"./chunk-S26VBWBL.js";import{a as j}from"./chunk-YGK54RN3.js";import"./chunk-XC4KBJWX.js";import{d as c,f as G,g as A,h as z,i as _,k as E,l as K,m as J,n as Y,o as $,p as D}from"./chunk-6I7XQ6OV.js";import"./chunk-CEWKWK6U.js";import"./chunk-SP6S2HTI.js";import{h as q,i as U}from"./chunk-GS7ZRR4M.js";import{k as Q,l as R,r as b,t as H}from"./chunk-WDQTWRWB.js";import{Eb as g,Fb as T,Ib as f,Kb as v,Lb as O,Nb as u,Ob as N,Ra as p,Sa as w,Vb as F,Xb as k,_b as B,ba as I,da as m,hb as C,ja as S,lb as d,qb as h,sa as x,ub as r,vb as a,wa as L,wb as y}from"./chunk-IYQR6SBG.js";import{a as M}from"./chunk-DM275RSA.js";var P=["otpInputElement"],ot=i=>({"ngx-blinking-cursor":i}),st=(i,l,n,t)=>({"ngx-otp-input-disabled":i,"ngx-otp-input-filled":l,"ngx-otp-input-success":n,"ngx-otp-input-failed":t});function rt(i,l){if(i&1&&y(0,"input",3,0),i&2){let n=l.$implicit,t=l.index,e=T();d("value",n.value)("type",e.inputType)("inputMode",e.ngxOtpOptions.inputMode)("disabled",e.disabled)("ngClass",B(5,st,e.disabled,e.isInputFilled(t),e.isOTPSuccess,e.isOTPFailed))}}var at=(()=>{class i{constructor(){this.handlePaste=new x}onPaste(n){n.preventDefault();let t=n.clipboardData?.getData("text");if(t&&this.regexp.test(t)){let e=t.split("");this.inputs.forEach((s,o)=>{e[o]&&(s.nativeElement.value=e[o])}),this.handlePaste.emit(e)}}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=m({type:i,selectors:[["","ngxOtpPaste",""]],contentQueries:function(t,e,s){if(t&1&&f(s,P,5),t&2){let o;v(o=O())&&(e.inputs=o)}},hostBindings:function(t,e){t&1&&g("paste",function(o){return e.onPaste(o)})},inputs:{regexp:"regexp"},outputs:{handlePaste:"handlePaste"},standalone:!0})}}return i})(),pt=(()=>{class i{ngAfterContentInit(){this.ngxAutoFocus&&this.firstInput&&this.firstInput.nativeElement.focus()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=m({type:i,selectors:[["","ngxAutoFocus",""]],contentQueries:function(t,e,s){if(t&1&&f(s,P,5),t&2){let o;v(o=O())&&(e.firstInput=o.first)}},inputs:{ngxAutoFocus:"ngxAutoFocus"},standalone:!0})}}return i})(),ut=(()=>{class i{constructor(){this.inputsArray=[],this.valueChange=new x}ngAfterContentInit(){this.inputsArray=this.inputs.toArray()}findInputIndex(n){return this.inputsArray.findIndex(t=>t.nativeElement===n)}setFocus(n){n>=0&&n<this.inputs.length&&this.inputsArray[n].nativeElement.focus()}onArrowLeft(n){let t=this.findInputIndex(n.target);t>0&&this.setFocus(t-1)}onArrowRight(n){let t=this.findInputIndex(n.target);t<this.inputs.length-1&&this.setFocus(t+1)}onBackspace(n){let t=this.findInputIndex(n.target);t>=0&&(this.valueChange.emit([t,""]),this.setFocus(t-1),n.preventDefault())}onKeyUp(n){let t=this.findInputIndex(n.target);n.data?.match(this.regexp)?(this.valueChange.emit([t,n.data]),this.setFocus(t+1)):this.inputsArray[t].nativeElement.value=""}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=m({type:i,selectors:[["","ngxInputNavigations",""]],contentQueries:function(t,e,s){if(t&1&&f(s,P,5),t&2){let o;v(o=O())&&(e.inputs=o)}},hostBindings:function(t,e){t&1&&g("keydown.arrowLeft",function(o){return e.onArrowLeft(o)})("keydown.arrowRight",function(o){return e.onArrowRight(o)})("keydown.backspace",function(o){return e.onBackspace(o)})("input",function(o){return e.onKeyUp(o)})},inputs:{regexp:"regexp"},outputs:{valueChange:"valueChange"},standalone:!0})}}return i})(),lt=(()=>{class i{constructor(){this.inputHTMLElements=[]}ngOnChanges(n){this.ngxAutoBlur&&this.inputHTMLElements.length>0&&n.isFormValid.currentValue&&this.inputHTMLElements.forEach(t=>{t.blur()})}ngAfterContentInit(){this.inputs.forEach(n=>{this.inputHTMLElements.push(n.nativeElement)})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=m({type:i,selectors:[["","ngxAutoBlur",""]],contentQueries:function(t,e,s){if(t&1&&f(s,P,5),t&2){let o;v(o=O())&&(e.inputs=o)}},inputs:{ngxAutoBlur:"ngxAutoBlur",isFormValid:"isFormValid"},standalone:!0,features:[S]})}}return i})(),dt=(()=>{class i{ngAfterContentInit(){this.setAriaLabelsAttrs()}getDefaultAriaLabelText(n){return`One Time Password Input Number ${n+1}`}setAriaLabelsAttrs(){this.inputs.forEach((n,t)=>{n.nativeElement.setAttribute("aria-label",this.ngxOtpAriaLabels[t]??this.getDefaultAriaLabelText(t))})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=m({type:i,selectors:[["","ngxOtpAriaLabels",""]],contentQueries:function(t,e,s){if(t&1&&f(s,P,5),t&2){let o;v(o=O())&&(e.inputs=o)}},inputs:{ngxOtpAriaLabels:"ngxOtpAriaLabels"},standalone:!0})}}return i})(),tt={otpLength:6,autoFocus:!0,autoBlur:!0,hideInputValues:!1,regexp:/^[0-9]+$/,showBlinkingCursor:!0,ariaLabels:[],inputMode:"numeric"},V=function(i){return i.SUCCESS="success",i.FAILED="failed",i}(V||{}),et=(()=>{class i{constructor(){this.ngxOtpOptions=tt,this.disabled=!1,this.otpChange=new x,this.otpComplete=new x}set options(n){this.ngxOtpOptions=M(M({},tt),n)}get ngxOtpOptionsInUse(){return this.ngxOtpOptions}get inputType(){return this.ngxOtpOptions.hideInputValues?"password":"text"}get isOTPSuccess(){return this.status===V.SUCCESS}get isOTPFailed(){return this.status===V.FAILED}ngOnInit(){this.initOtpInputArray()}ngOnChanges(n){let t=n.otp;t?.currentValue&&(t.firstChange?this.ngxOtpOptions.autoFocus=!1:this.setInitialOtp(t.currentValue))}initOtpInputArray(){this.ngxOtpInputArray=new Y(Array.from({length:this.ngxOtpOptions.otpLength},()=>new _("",c.required))),this.otp&&this.setInitialOtp(this.otp)}setInitialOtp(n){if(this.ngxOtpOptions.regexp.test(n)){let t=n.split("");t.forEach((e,s)=>{this.ngxOtpInputArray.controls[s].setValue(e??"")}),this.emitOtpValueChange(),t.length!==this.ngxOtpOptions.otpLength&&console.warn("OTP length does not match the provided otpLength option!")}else throw new Error("Invalid OTP provided for the component <ngx-otp-input>")}handleInputChanges(n){let[t,e]=n;this.ngxOtpInputArray.controls[t].setValue(e),this.emitOtpValueChange()}handlePasteChange(n){n.length===this.ngxOtpOptions.otpLength?this.ngxOtpInputArray.setValue(n):n.map((t,e)=>{this.ngxOtpInputArray.controls[e]?.setValue?.(t)}),this.emitOtpValueChange()}emitOtpValueChange(){this.otpChange.emit(this.ngxOtpInputArray.value),this.ngxOtpInputArray.valid&&this.otpComplete.emit(this.ngxOtpInputArray.value.join(""))}isInputFilled(n){return!!this.ngxOtpInputArray.controls[n].value}reset(){this.ngxOtpInputArray.reset()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=I({type:i,selectors:[["ngx-otp-input"]],inputs:{options:"options",status:"status",disabled:"disabled",otp:"otp"},outputs:{otpChange:"otpChange",otpComplete:"otpComplete"},standalone:!0,features:[S,F],decls:2,vars:9,consts:[["otpInputElement",""],["ngxOtpPaste","","ngxInputNavigations","","data-testid","ngx-otp-input-form",1,"ngx-otp-input-form",3,"valueChange","handlePaste","regexp","isFormValid","ngxAutoFocus","ngxAutoBlur","ngxOtpAriaLabels","ngClass"],["class","ngx-otp-input-box","maxlength","1","spellcheck","false","autocomplete","off","autocapitalize","off","autocorrect","off","data-testid","ngx-otp-input-box",3,"value","type","inputMode","disabled","ngClass",4,"ngFor","ngForOf"],["maxlength","1","spellcheck","false","autocomplete","off","autocapitalize","off","autocorrect","off","data-testid","ngx-otp-input-box",1,"ngx-otp-input-box",3,"value","type","inputMode","disabled","ngClass"]],template:function(t,e){t&1&&(r(0,"form",1),g("valueChange",function(o){return e.handleInputChanges(o)})("handlePaste",function(o){return e.handlePasteChange(o)}),C(1,rt,2,10,"input",2),a()),t&2&&(d("regexp",e.ngxOtpOptions.regexp)("isFormValid",e.ngxOtpInputArray.valid)("ngxAutoFocus",e.ngxOtpOptions.autoFocus)("ngxAutoBlur",e.ngxOtpOptions.autoBlur)("ngxOtpAriaLabels",e.ngxOtpOptions.ariaLabels)("ngClass",k(7,ot,e.ngxOtpOptions.showBlinkingCursor)),p(),d("ngForOf",e.ngxOtpInputArray.controls))},dependencies:[b,Q,R,D,E,A,at,pt,ut,lt,dt],styles:[".ngx-otp-input-form[_ngcontent-%COMP%]{display:inline-flex;gap:.5rem;caret-color:transparent}.ngx-blinking-cursor[_ngcontent-%COMP%]{caret-color:initial}.ngx-otp-input-box[_ngcontent-%COMP%]{width:30px;height:35px;padding:.5rem;font-size:1.5rem;text-align:center;border:1px solid #c4c4c4;border-radius:.5rem;outline:none}.ngx-otp-input-box[_ngcontent-%COMP%]:focus{border-color:#007bff}"]})}}return i})();function gt(i,l){i&1&&(r(0,"div",7)(1,"small",18),u(2,"otp required*"),a()())}function ct(i,l){i&1&&(r(0,"div",7)(1,"small",18),u(2,'"Incorrect OTP. Please try again."*'),a()())}function mt(i,l){i&1&&(r(0,"div",7)(1,"small",18),u(2,"password and rePassword required*"),a()())}function ht(i,l){i&1&&(r(0,"div",7)(1,"small",18),u(2,"password minlength (8) characters*"),a()())}function ft(i,l){i&1&&(r(0,"div",7)(1,"small",18),u(2,"password and rePassword must be same*"),a()())}var qt=(()=>{class i{constructor(n,t,e,s){this._PLATFORM_ID=n,this._Router=t,this._ToastrService=e,this._PrivacySettingsService=s,this.startValidation=!1,this.isValidOtp=!1,this.otpValue="",this.otpOptions={length:6,allowNumbersOnly:!0,hideInputValues:!1,autoBlur:!0},this.userPasswordForm=new z({password:new _("",[c.required,c.minLength(8)]),rePassword:new _("",[c.required,c.minLength(8)])},{validators:this.passwordMatchValidators})}ngOnInit(){this.getUserEmail(),this.userEmail||this._Router.navigate(["/login/reset"])}onOtpChange(n){this.otpValue=n.join(""),this.isValidOtp=!1}onSubmitUpdateUserPassword(){if(this.startValidation=!0,this.userPasswordForm.valid&&this.otpValue.length===6){let n={email:this.userEmail,password:+(this.userPasswordForm.value.password||0),reset_code:+this.otpValue};this._PrivacySettingsService.updateUserForgetPassword(n).subscribe({next:t=>{t.success?(this.startValidation=!1,this._ToastrService.success("Password Changed"),this._Router.navigate(["/login"])):this.isValidOtp=!0}}),console.log(n)}}passwordMatchValidators(n){let t=n.get("password")?.value,e=n.get("rePassword")?.value;return t&&e&&t!==e?{passwordMismatch:!0}:null}get password(){return this.userPasswordForm.get("password")}get rePassword(){return this.userPasswordForm.get("rePassword")}getUserEmail(){H(this._PLATFORM_ID)&&(this.userEmail=JSON.parse(localStorage.getItem("email")))}static{this.\u0275fac=function(t){return new(t||i)(w(L),w(q),w(j),w(Z))}}static{this.\u0275cmp=I({type:i,selectors:[["app-forget-password-otp"]],standalone:!0,features:[F],decls:32,vars:12,consts:[[1,"text-center","text-capitalize"],[1,"mb-0","h4"],[1,"text-dark","text-opacity-75","mb-0"],[1,"fw-bold"],[1,"p-3",3,"ngSubmit","formGroup"],[1,"mb-5","mt-4","col-md-8","mx-auto"],[3,"otpChange","options"],[1,"col-12"],[1,"mb-4"],[1,"row","g-3"],[1,"col-md-8","mx-auto"],["formControlName","password",1,"form-control","p-0",3,"feedback","toggleMask"],["formControlName","rePassword",1,"form-control","p-0",3,"feedback","toggleMask"],[1,"mb-2"],[1,"btn","btn-secondary","px-5","py-3"],[1,"d-flex","justify-content-between"],[1,"btn"],["routerLink","/login/reset",1,"btn"],[1,"fst-italic","fw-bold","text-danger"]],template:function(t,e){t&1&&(r(0,"div",0)(1,"p",1),u(2,"please enter the (OTP) to verify your account"),a(),r(3,"p",2),u(4," A One-Time Password has been sent to "),r(5,"span",3),u(6),a()(),r(7,"form",4),g("ngSubmit",function(){return e.onSubmitUpdateUserPassword()}),r(8,"div",5)(9,"ngx-otp-input",6),g("otpChange",function(o){return e.onOtpChange(o)}),a(),C(10,gt,3,0,"div",7)(11,ct,3,0,"div",7),a(),r(12,"h3",8),u(13,"Please Enter Your New Password"),a(),r(14,"div",9)(15,"div",10)(16,"div"),y(17,"p-password",11),a()(),r(18,"div",10)(19,"div"),y(20,"p-password",12),a()(),C(21,mt,3,0,"div",7)(22,ht,3,0,"div",7)(23,ft,3,0,"div",7),r(24,"div",13)(25,"button",14),u(26,"Change Password"),a()()()(),r(27,"div",15)(28,"button",16),u(29,"Resend One-Time Password"),a(),r(30,"button",17),u(31,"Enter a wrong email?"),a()()()),t&2&&(p(6),N(e.userEmail),p(),d("formGroup",e.userPasswordForm),p(2),d("options",e.otpOptions),p(),h(10,e.otpValue.length!==6&&e.startValidation?10:-1),p(),h(11,e.isValidOtp&&e.startValidation?11:-1),p(6),d("feedback",!1)("toggleMask",!0),p(3),d("feedback",!1)("toggleMask",!0),p(),h(21,e.password!=null&&e.password.getError("required")&&e.startValidation||e.rePassword!=null&&e.rePassword.getError("required")&&e.startValidation?21:-1),p(),h(22,e.password!=null&&e.password.getError("minlength")&&e.startValidation||e.rePassword!=null&&e.rePassword.getError("minlength")&&e.startValidation?22:-1),p(),h(23,e.userPasswordForm.errors!=null&&e.userPasswordForm.errors.passwordMismatch&&e.startValidation?23:-1))},dependencies:[D,E,G,A,K,J,U,et,b,X,W,$],styles:["input.ngx-otp-input-box{width:100%!important;height:60px!important}input[_ngcontent-%COMP%],   .p-password{min-width:100%!important;height:60px!important}"]})}}return i})();export{qt as ForgetPasswordOtpComponent};
